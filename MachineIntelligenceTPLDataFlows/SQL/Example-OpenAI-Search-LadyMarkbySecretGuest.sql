DBCC FREESESSIONCACHE
DBCC FREEPROCCACHE
DBCC DROPCLEANBUFFERS
SET NOCOUNT ON
SET STATISTICS TIME ON
SET STATISTICS IO ON
go

-- What Did the Raven Say
declare @jsonOpenAIEmbeddings nvarchar(max) = N'{
    "object": "list",
    "data": [
        {
            "object": "embedding",
            "index": 0,
            "embedding": [
                0.003889656,
                -0.020141581,
                -0.009081288,
                -0.011138412,
                0.021170143,
                0.03585644,
                -0.012336231,
                0.005478068,
                -0.035570007,
                -0.00364879,
                0.014074369,
                0.002418422,
                -0.031273484,
                0.010949626,
                -0.002055496,
                0.00675726,
                0.02141752,
                0.0065619634,
                0.010832448,
                -0.028487254,
                -0.0016038727,
                0.013826994,
                0.015819019,
                -0.0022296354,
                -0.010734799,
                0.0058296015,
                0.00730409,
                -0.01859223,
                0.011431357,
                0.019295298,
                -0.0038050273,
                0.009107328,
                0.0022198705,
                -0.019386435,
                -0.014334765,
                -0.028539332,
                -0.004599233,
                0.0054194788,
                0.04064772,
                -0.027211316,
                0.0118740285,
                -0.0022410275,
                -0.006350392,
                0.0051916325,
                -0.031351604,
                0.015779959,
                0.016222632,
                -0.009100818,
                -0.019165099,
                0.0062267045,
                0.03614288,
                0.015714861,
                -0.018318815,
                -0.007655624,
                -0.0168606,
                0.010747819,
                -0.000060674156,
                0.004937747,
                0.008612577,
                -0.010864996,
                -0.0047977846,
                -0.016105454,
                -0.010500443,
                -0.006965576,
                -0.019581731,
                0.010448365,
                -0.00422817,
                -0.005842621,
                -0.014738378,
                0.009777846,
                0.0136577375,
                0.0029408403,
                0.01631377,
                -0.010656681,
                0.01572788,
                -0.037288617,
                -0.034033675,
                0.004124012,
                -0.01518105,
                0.010018712,
                0.0009960122,
                -0.022055488,
                -0.0013947428,
                0.040100887,
                0.026625426,
                -0.0019578477,
                0.0006261695,
                0.009550001,
                -0.030961009,
                -0.016678324,
                0.035465848,
                0.023474643,
                -0.0148164965,
                0.0035641617,
                -0.011457397,
                0.0029668796,
                -0.034502387,
                0.020675393,
                0.015675802,
                -0.018514112,
                0.0069395364,
                0.0048173144,
                -0.029450716,
                -0.004618763,
                -0.001590853,
                -0.002242655,
                -0.005972819,
                -0.0128960805,
                0.011437867,
                0.0023923824,
                -0.015493524,
                0.0107152695,
                0.008801363,
                -0.0025714042,
                0.0039189504,
                -0.023513703,
                -0.00013172344,
                -0.016378868,
                -0.016118474,
                -0.012648705,
                0.01857921,
                0.026247853,
                -0.0063276077,
                -0.0049800617,
                0.0053641447,
                0.00036231574,
                0.0055919904,
                0.004488565,
                -0.0099405935,
                0.0032110005,
                0.026690526,
                -0.0096867075,
                0.014009271,
                0.008078766,
                -0.014764418,
                0.008938071,
                -0.043538105,
                0.019503614,
                -0.008274063,
                -0.041298706,
                -0.013709816,
                0.036689706,
                -0.010266087,
                0.0009740414,
                -0.02529741,
                0.009146388,
                0.017120995,
                -0.0046871165,
                0.012427369,
                -0.0020327114,
                0.009777846,
                0.01351452,
                0.0029831545,
                -0.030778732,
                0.0057156784,
                0.018969802,
                -0.004563429,
                0.0024574813,
                -0.02702904,
                -0.011978187,
                0.016404908,
                0.028773688,
                0.019282278,
                0.001913906,
                0.020089503,
                0.018201636,
                0.0010415815,
                0.014100409,
                -0.009641139,
                -0.002667425,
                -0.0036943592,
                0.014425904,
                -0.044163056,
                0.013853034,
                0.012655215,
                0.007955079,
                0.005048415,
                -0.0139181325,
                -0.006633572,
                -0.03304417,
                -0.025648944,
                0.011444377,
                0.013618678,
                0.029580913,
                -0.025531765,
                0.015220109,
                0.0093026245,
                -0.0125119975,
                0.012590116,
                -0.0127593735,
                0.027211316,
                0.039241582,
                0.012713804,
                -0.021677915,
                -0.672445,
                -0.014373824,
                -0.017277233,
                0.020948807,
                0.009797376,
                0.014543082,
                0.008371711,
                0.005943524,
                -0.0005423547,
                0.0005704286,
                -0.022276824,
                0.013039298,
                0.011053784,
                0.023878256,
                -0.008553988,
                -0.0029831545,
                0.005289281,
                -0.016691344,
                0.006031408,
                0.02419073,
                -0.0031638038,
                0.028200818,
                0.008638617,
                -0.006913497,
                0.00021116437,
                0.009068268,
                0.016014315,
                -0.015233129,
                -0.027706068,
                0.0062657637,
                -0.019360395,
                0.010969155,
                -0.029476756,
                -0.011659203,
                0.04947512,
                -0.0028806238,
                -0.011574574,
                0.046871167,
                0.0016266573,
                0.006822359,
                -0.0077272328,
                -0.021612816,
                -0.012407839,
                0.0016697854,
                -0.0015827157,
                0.0033493354,
                0.010604601,
                0.014269666,
                -0.030283982,
                0.003375375,
                0.0067702797,
                0.02529741,
                -0.016925698,
                0.009087798,
                -0.020024404,
                -0.0030954499,
                0.005940269,
                -0.011118882,
                0.0016413046,
                0.0082805725,
                -0.024984935,
                0.031169325,
                0.008690695,
                -0.014712338,
                -0.0006135566,
                0.0047750003,
                -0.0017853357,
                0.028409135,
                0.01348848,
                -0.00055374706,
                -0.0018781016,
                0.025609884,
                -0.022081528,
                0.0103246765,
                0.01854015,
                0.017251194,
                -0.0043486026,
                0.0010871507,
                -0.011190491,
                -0.009159408,
                0.02757587,
                -0.0013564972,
                -0.037314657,
                -0.002249165,
                0.0506469,
                -0.002086418,
                -0.028200818,
                0.0006481403,
                0.0036943592,
                -0.014855556,
                0.013540559,
                0.028252898,
                -0.01799332,
                -0.008807873,
                -0.003987304,
                0.004530879,
                -0.0065131392,
                0.018696388,
                0.009257056,
                -0.032653578,
                0.008078766,
                -0.018917724,
                0.013345263,
                0.0006977782,
                0.021573756,
                0.0053023007,
                -0.011913088,
                0.007909509,
                0.017771984,
                -0.017316293,
                -0.0004760353,
                -0.010057772,
                0.0050386502,
                -0.016079415,
                -0.01464724,
                -0.02976319,
                0.041819498,
                0.0060834866,
                0.016144512,
                -0.049318884,
                0.014126449,
                0.021026926,
                -0.00042192187,
                -0.019907227,
                0.0047522155,
                0.02419073,
                0.0037594582,
                -0.02921636,
                -0.016157532,
                0.018748466,
                0.011118882,
                -0.011014724,
                0.040257122,
                -0.022029448,
                0.016053375,
                -0.01683456,
                0.022693457,
                -0.011197001,
                0.01293514,
                0.005497597,
                -0.0056343046,
                0.007186912,
                -0.00021889486,
                -0.0038505965,
                -0.006187645,
                -0.01794124,
                -0.01459516,
                -0.016417928,
                -0.040231086,
                0.029632993,
                -0.0027341514,
                0.0070892638,
                -0.02247212,
                0.0012775648,
                -0.01011636,
                0.009973142,
                -0.0118545,
                0.0031345093,
                -0.0070567145,
                0.004963787,
                0.008710225,
                0.016209612,
                -0.02475058,
                0.004612253,
                0.011555045,
                -0.021183163,
                0.014491002,
                0.012095365,
                -0.021860192,
                -0.020961827,
                0.0047750003,
                -0.011763361,
                -0.014855556,
                -0.005797052,
                -0.0061160363,
                -0.01630075,
                -0.009836435,
                0.00081617676,
                -0.013371302,
                -0.008326142,
                0.0025714042,
                0.011190491,
                -0.0032549421,
                -0.0033281783,
                0.0075319363,
                0.016391888,
                0.026143694,
                -0.0038408318,
                0.016170552,
                0.010168439,
                -0.008358692,
                0.0090422295,
                0.012525017,
                0.008261043,
                0.0038505965,
                -0.01070876,
                0.010370245,
                -0.0018748466,
                -0.010591581,
                0.015988275,
                0.027653988,
                -0.00449833,
                0.032966055,
                -0.022459101,
                -0.00068068976,
                -0.029372597,
                0.014009271,
                -0.015532584,
                0.009654159,
                0.0056505795,
                0.01967287,
                -0.023774097,
                -0.0074928766,
                -0.007258521,
                0.030908931,
                0.030700615,
                -0.0030515082,
                -0.005836111,
                -0.015024813,
                -0.008586537,
                -0.024386026,
                -0.019008862,
                -0.00023984855,
                0.009068268,
                -0.01854015,
                0.007909509,
                0.005432498,
                -0.0010269342,
                -0.0047587254,
                -0.008085276,
                -0.0065717283,
                0.006965576,
                0.00096671784,
                0.011763361,
                0.0075124064,
                -0.0085279485,
                0.0074342876,
                -0.019777028,
                0.024698501,
                -0.030544376,
                -0.002062006,
                0.011372767,
                0.014530062,
                -0.022185685,
                0.010259578,
                0.012453409,
                0.018396933,
                0.024008453,
                0.0020571235,
                0.008560497,
                0.010956136,
                0.0035218473,
                0.002975017,
                0.015871098,
                0.017329311,
                -0.023943353,
                -0.00020821458,
                0.0082805725,
                0.005569206,
                0.029919429,
                -0.018188616,
                -0.011047274,
                0.008052727,
                0.0038440865,
                0.018683368,
                0.0023337936,
                -0.00097160024,
                -0.0109626455,
                0.003984049,
                -0.009061758,
                0.014256647,
                -0.0026592878,
                0.0014240372,
                0.007694683,
                0.01682154,
                -0.02697696,
                0.0049735517,
                0.005120024,
                0.012811452,
                0.0168606,
                0.00225893,
                -0.024047513,
                0.03038814,
                0.024529245,
                -0.015168031,
                -0.016990798,
                -0.0014989008,
                0.010799898,
                -0.009276585,
                0.017719906,
                0.028070621,
                0.005523637,
                0.0009040602,
                -0.019816088,
                0.014087389,
                -0.01969891,
                0.01967287,
                -0.0058296015,
                0.025974438,
                -0.009921064,
                0.012179993,
                -0.0048140595,
                -0.019946285,
                -0.041272666,
                0.0034046695,
                -0.009406783,
                -0.01576694,
                -0.016131492,
                -0.021873211,
                -0.0051883776,
                -0.010741309,
                0.01575392,
                -0.027680028,
                -0.028383095,
                -0.000793799,
                0.038538516,
                -0.014451943,
                0.024242809,
                0.027393593,
                0.023279347,
                -0.003147529,
                -0.019750988,
                -0.023852216,
                0.008078766,
                0.15509148,
                0.031325564,
                0.01856619,
                0.0056635994,
                0.021886231,
                -0.003116607,
                -0.02031084,
                -0.011470416,
                0.026898842,
                0.0031556664,
                -0.009823415,
                0.0057091685,
                -0.009296115,
                0.028357055,
                0.011535515,
                -0.0059305048,
                0.0011392297,
                0.0060509373,
                0.009120348,
                -0.018696388,
                0.013761896,
                -0.016548125,
                -0.014451943,
                -0.0001524737,
                -0.015011793,
                -0.015845058,
                -0.009439332,
                0.0072259717,
                0.0034079244,
                0.0032630796,
                -0.013748876,
                0.012538037,
                -0.004618763,
                0.024503205,
                0.0033981595,
                -0.018214656,
                -0.00080885313,
                0.0012165346,
                0.015506544,
                -0.020571234,
                0.02981527,
                0.009953613,
                0.01008381,
                0.004722921,
                0.01796728,
                0.011372767,
                -0.013182515,
                0.009387253,
                0.0005024817,
                -0.032471303,
                0.06431766,
                0.011574574,
                -0.0011677105,
                0.00535438,
                0.005562696,
                0.020558214,
                0.0020229465,
                -0.0075058965,
                -0.012349251,
                0.048667893,
                -0.013553579,
                -0.031065168,
                0.012004226,
                -0.015324268,
                -0.010637151,
                -0.016808521,
                -0.02697696,
                0.0004658636,
                0.0014696064,
                -0.017850103,
                -0.0012116522,
                -0.023240287,
                -0.0026511503,
                0.00535438,
                0.022289844,
                0.021599796,
                0.0073887184,
                -0.027107159,
                0.0024119122,
                0.013306203,
                -0.021808112,
                0.00077711744,
                -0.006350392,
                -0.010409305,
                -0.0052534766,
                -0.0057059135,
                0.016443968,
                -0.019321337,
                -0.020154601,
                0.0056701093,
                0.0070176553,
                0.020011384,
                0.006285293,
                -0.013748876,
                -0.008703715,
                0.007375699,
                -0.022641378,
                -0.0074993866,
                -0.018318815,
                0.0140483305,
                0.023318406,
                -0.018605249,
                -0.002249165,
                -0.0026120911,
                -0.012642195,
                0.0026657975,
                -0.003420944,
                -0.019946285,
                -0.022758555,
                0.01683456,
                0.024255829,
                -0.013892093,
                0.0051590833,
                0.00025022367,
                0.00449182,
                -0.004039383,
                0.0031296269,
                0.016391888,
                -0.001363007,
                -0.008703715,
                0.013228085,
                -0.016470008,
                0.019750988,
                0.018110499,
                0.00061925274,
                0.02984131,
                -0.00067743484,
                -0.021274302,
                -0.00898364,
                -0.00590121,
                0.0016925699,
                -0.00095125684,
                -0.0015021558,
                -0.025115134,
                -0.027003,
                -0.0024330693,
                0.0071218135,
                0.0032858641,
                -0.021300342,
                -0.0018292775,
                -0.039215542,
                0.013709816,
                -0.004104482,
                -0.01572788,
                -0.009738787,
                -0.027680028,
                -0.0016811776,
                0.0052957907,
                -0.025674984,
                0.03197655,
                -0.025037015,
                0.012687764,
                -0.007642604,
                0.007694683,
                0.0011913088,
                -0.043512065,
                -0.000563105,
                0.0023744802,
                0.018657329,
                0.016938718,
                0.047938786,
                -0.008742775,
                0.017160054,
                -0.0074407975,
                -0.0018911214,
                -0.010220518,
                -0.0007636908,
                -0.015441446,
                -0.018501092,
                0.00902921,
                0.02018064,
                0.0056961486,
                0.030049626,
                0.008606067,
                -0.008462849,
                0.0058947,
                -0.014881595,
                -0.00393848,
                -0.008606067,
                -0.012108385,
                -0.0028041326,
                -0.0030287236,
                -0.015441446,
                0.004833589,
                -0.0125119975,
                -0.012160464,
                0.00675075,
                -0.006783299,
                0.0122516025,
                -0.020623313,
                0.01856619,
                -0.01067621,
                0.020662373,
                -0.00058426213,
                -0.01459516,
                -0.0060509373,
                0.011587594,
                0.0006351206,
                0.018605249,
                -0.0026186008,
                0.009484901,
                0.016951738,
                -0.013234595,
                0.015480504,
                0.00028501087,
                0.049162645,
                0.015467485,
                -0.0047750003,
                0.019816088,
                -0.009634629,
                -0.022693457,
                -0.02193831,
                -0.03991861,
                -0.040126927,
                0.00047155973,
                -0.009120348,
                -0.0030905677,
                0.0143087255,
                -0.016652284,
                -0.02079257,
                -0.02921636,
                -0.01458214,
                0.031221405,
                0.030127745,
                0.019256238,
                -0.0035381222,
                -0.003427454,
                -0.007811861,
                0.030882891,
                0.0011864264,
                0.008885992,
                0.006298313,
                0.024698501,
                -0.0070957737,
                0.0073952284,
                -0.007636094,
                0.0039091855,
                -0.018357873,
                -0.01748555,
                0.0258182,
                0.0050842194,
                0.00033668306,
                -0.015089911,
                -0.013006749,
                0.00451786,
                -0.0015607447,
                -0.015259169,
                -0.009790866,
                -0.0056668543,
                0.008514929,
                -0.023188207,
                -0.030830812,
                -0.0012547802,
                0.030518338,
                -0.0048108045,
                -0.0014549592,
                0.012388309,
                0.0013548697,
                0.0037627132,
                -0.0022361453,
                -0.016938718,
                0.021079006,
                0.0085279485,
                -0.00021401244,
                -0.0034567486,
                0.00196924,
                -0.006422001,
                -0.019230198,
                -0.0033395707,
                0.026052557,
                0.013384322,
                0.011620143,
                0.008619087,
                0.007766292,
                0.011678732,
                -0.0004455202,
                0.009608589,
                -0.002442834,
                0.023735037,
                -0.017902182,
                0.009680198,
                0.020401977,
                -0.0065977676,
                -0.00843681,
                -0.009152898,
                -0.022641378,
                -0.01348848,
                -0.021782072,
                -0.0064870995,
                0.0033102762,
                -0.01965985,
                -0.019737968,
                -0.027393593,
                0.021990389,
                -0.0066726315,
                -0.022302864,
                -0.011691752,
                0.015949216,
                -0.023175187,
                -0.010923586,
                -0.022459101,
                0.012655215,
                -0.0148164965,
                0.008521439,
                -0.0023923824,
                0.008078766,
                0.033955555,
                0.011522495,
                0.00079786766,
                -0.004944257,
                0.009074778,
                -0.015858078,
                0.009165917,
                -0.017029857,
                0.024464145,
                -0.011496455,
                -0.010337696,
                0.011594104,
                -0.012765883,
                0.028591411,
                0.003430709,
                0.007844411,
                0.018696388,
                -0.024958896,
                0.0052013975,
                0.010851977,
                0.0060379175,
                0.00090080523,
                -0.03213279,
                -0.011275119,
                0.014738378,
                0.008677675,
                -0.022576278,
                -0.026664486,
                -0.007987628,
                -0.014907635,
                -0.0180454,
                0.021274302,
                0.0010871507,
                0.019529652,
                0.008235004,
                0.0035804363,
                0.0035283573,
                -0.0006867928,
                -0.00020058581,
                0.011880538,
                0.004104482,
                0.0010798271,
                -0.02592236,
                -0.026872803,
                -0.019008862,
                0.013299693,
                -0.007238991,
                -0.027185276,
                -0.014699318,
                0.015115951,
                -0.032861896,
                -0.013000239,
                -0.008059237,
                0.019581731,
                0.018618269,
                0.011672222,
                0.01068272,
                0.015102931,
                0.007421268,
                0.026586367,
                -0.032679617,
                -0.003821302,
                0.016938718,
                -0.008820893,
                0.0146212,
                0.0019334357,
                -0.008117826,
                -0.00091789366,
                -0.015662782,
                0.003987304,
                0.003427454,
                0.014530062,
                -0.026794683,
                -0.01736837,
                -0.023774097,
                -0.0007498573,
                -0.002473756,
                0.007798841,
                0.0066563566,
                -0.0053706546,
                -0.011418337,
                0.005504107,
                -0.0053153206,
                -0.030466259,
                -0.0052144174,
                0.03590852,
                0.0049800617,
                0.013774915,
                -0.015571643,
                -0.006350392,
                -0.019620791,
                0.0028334272,
                0.025557805,
                -0.031273484,
                -0.005458538,
                0.019946285,
                0.00082268665,
                -0.013286673,
                0.020336878,
                0.044631768,
                -0.008781834,
                -0.037470892,
                -0.006428511,
                -0.007590525,
                0.0052274372,
                0.001803238,
                -0.009543491,
                -0.005041905,
                -0.013722836,
                -0.00021604678,
                -0.00016742609,
                -0.009081288,
                -0.0016909424,
                -0.0015444701,
                -0.0157409,
                0.016743422,
                -0.009139878,
                -0.0029864095,
                -0.017706886,
                -0.006392706,
                0.009126858,
                -0.0072845602,
                0.008000648,
                0.0048596286,
                -0.0044006817,
                0.0012848884,
                0.016483027,
                0.0013174379,
                0.004150051,
                0.0076100547,
                0.23435584,
                -0.025037015,
                -0.019933265,
                0.039189503,
                -0.0051428084,
                0.0026397582,
                0.025154192,
                0.011633163,
                -0.008872972,
                0.00045813312,
                -0.01458214,
                0.00899666,
                -0.013800954,
                -0.0004365691,
                0.0043681324,
                -0.0058296015,
                -0.01800634,
                -0.059213907,
                -0.0086646555,
                -0.025661964,
                0.0020164365,
                0.016118474,
                0.0014329882,
                -0.020714452,
                0.025935378,
                -0.006698671,
                -0.016053375,
                -0.010819428,
                0.004602488,
                0.013722836,
                -0.0118740285,
                -0.008703715,
                -0.012010736,
                -0.00030555768,
                0.001941573,
                -0.0013581245,
                0.0130197685,
                -0.009270075,
                0.008378221,
                0.017055897,
                0.007948569,
                0.007753272,
                -0.007974608,
                0.0028301722,
                0.015610702,
                -0.008072256,
                -0.0021010651,
                -0.018201636,
                -0.010650171,
                0.013247615,
                -0.02869557,
                -0.02587028,
                0.0036162408,
                0.01178289,
                -0.0036911045,
                -0.00841077,
                0.021795092,
                0.029997546,
                -0.035543967,
                -0.024932856,
                -0.01012287,
                0.023839196,
                -0.009589059,
                0.018800545,
                -0.0077337427,
                0.032262985,
                -0.033929516,
                -0.0070697344,
                -0.006913497,
                -0.017589707,
                0.0024721285,
                -0.0046448023,
                0.013065338,
                -0.015467485,
                -0.0028057601,
                -0.038147923,
                0.020362917,
                -0.013110907,
                0.022940831,
                0.015714861,
                -0.021013906,
                0.0066140424,
                0.0036976142,
                -0.023474643,
                -0.013579618,
                -0.03658555,
                0.010181459,
                0.00052567315,
                -0.0057579926,
                -0.013813974,
                0.016105454,
                -0.023331424,
                -0.0019090235,
                0.02132638,
                0.022576278,
                0.014126449,
                -0.013644718,
                0.011763361,
                -0.0053218305,
                -0.011092843,
                -0.031716157,
                -0.020011384,
                0.011542025,
                -0.014204567,
                -0.021508658,
                0.009712747,
                0.0011587593,
                0.017798023,
                0.020102523,
                -0.018982822,
                -0.01068272,
                -0.002193831,
                0.004540644,
                0.002525835,
                0.022420041,
                0.019998364,
                0.013787935,
                -0.0014980871,
                0.01803238,
                -0.022081528,
                -0.004127267,
                -0.015024813,
                -0.0011872401,
                0.015506544,
                0.0016323535,
                -0.0026072087,
                -0.0070111454,
                0.01016193,
                -0.008951091,
                -0.025232311,
                0.020909749,
                -0.0051590833,
                0.01179591,
                -0.019777028,
                -0.0071283234,
                0.0036194955,
                0.03189843,
                -0.027653988,
                -0.0258182,
                -0.00074538175,
                0.019113021,
                0.0022719495,
                0.0105850715,
                0.0023256561,
                0.016079415,
                -0.007375699,
                0.025518747,
                -0.016756441,
                -0.0015810882,
                -0.02132638,
                -0.042965237,
                -0.0052957907,
                -0.014777437,
                -0.020610293,
                0.017081937,
                -0.015923176,
                -0.010982174,
                -0.010409305,
                0.010214008,
                0.005393439,
                -0.019490594,
                0.01070876,
                0.021743013,
                -0.007916019,
                -0.0030189587,
                0.0022507925,
                -0.1667572,
                0.015272188,
                0.013234595,
                -0.016795501,
                0.028877847,
                0.005399949,
                0.0041956203,
                -0.0038408318,
                -0.02635201,
                0.020974847,
                0.022732515,
                0.0071153035,
                -0.036663666,
                -0.0018227675,
                0.010057772,
                0.022823654,
                -0.011340219,
                -0.009126858,
                0.025557805,
                0.0202197,
                0.031351604,
                -0.0066238074,
                0.015050853,
                -0.006402471,
                0.011183981,
                -0.012414349,
                -0.013774915,
                0.019620791,
                -0.016613225,
                -0.011906578,
                -0.026872803,
                -0.002708112,
                0.022589298,
                0.009139878,
                0.020441037,
                0.01738139,
                0.013566598,
                -0.014425904,
                -0.016378868,
                0.01292212,
                0.012232073,
                0.03929366,
                0.012824472,
                0.0087883435,
                -0.006252744,
                0.018227676,
                0.012069325,
                0.02929448,
                -0.014425904,
                -0.0077923313,
                0.008313122,
                -0.026260873,
                0.04835542,
                -0.012147444,
                0.011450887,
                0.043824542,
                0.0008129218,
                -0.0039124405,
                0.0129091,
                -0.011079823,
                0.0017592962,
                -0.020401977,
                0.01859223,
                -0.0043551126,
                -0.011626653,
                0.012642195,
                -0.011047274,
                -0.0024135397,
                -0.002963625,
                0.020935787,
                -0.013644718,
                -0.026794683,
                0.023279347,
                -0.0031068423,
                0.008729755,
                -0.0061583505,
                0.00044511334,
                0.005969564,
                0.004084952,
                -0.008794853,
                -0.03223695,
                0.025232311,
                -0.021131083,
                0.0062592537,
                0.0000080356385,
                0.0042932685,
                0.02361786,
                -0.009471881,
                -0.0019220433,
                -0.0020099268,
                -0.00006932009,
                -0.02705508,
                -0.007427778,
                -0.044084936,
                0.016027335,
                0.020011384,
                0.011411827,
                -0.0099405935,
                -0.0026316207,
                -0.020024404,
                -0.014868575,
                -0.0038408318,
                -0.010734799,
                0.025349488,
                0.03489298,
                0.015389366,
                -0.009491411,
                -0.00007410079,
                0.037470892,
                -0.022927811,
                -0.012362271,
                -0.0071022836,
                0.037444856,
                0.013202045,
                -0.0042444444,
                0.02872161,
                -0.00008081411,
                -0.021013906,
                0.031091208,
                -0.016626244,
                0.06275529,
                0.0071543627,
                0.016066395,
                0.012700784,
                -0.0069851056,
                0.015845058,
                -0.09462768,
                -0.030049626,
                -0.014803477,
                -0.0015404014,
                0.0018846114,
                0.0056831287,
                0.0019513378,
                -0.021690935,
                0.00732362,
                0.004680607,
                -0.0051883776,
                -0.0213394,
                -0.0034730232,
                -0.011698262,
                0.02075351,
                0.003433964,
                0.012472938,
                -0.019894207,
                -0.01294816,
                -0.0046415473,
                -0.004146796,
                0.003879891,
                -0.0004947512,
                -0.015545604,
                -0.0011213275,
                -0.026625426,
                -0.030726654,
                0.025440628,
                0.01735535,
                0.006692161,
                0.005002846,
                -0.011522495,
                -0.0013898603,
                -0.009191956,
                -0.0017869632,
                -0.0108389575,
                -0.013423381,
                0.0034469836,
                0.0043323277,
                -0.053485207,
                0.021886231,
                0.0063829413,
                -0.001157132,
                -0.023969393,
                -0.018175596,
                0.0021775563,
                -0.010832448,
                0.01458214,
                0.030518338,
                -0.004163071,
                -0.022237765,
                -0.008091786,
                -0.022680437,
                -0.0069525563,
                0.032835856,
                -0.015532584,
                0.000507771,
                0.02645617,
                -0.022628358,
                -0.021795092,
                -0.02648221,
                -0.011600614,
                -0.017693866,
                -0.0019562203,
                -0.01009683,
                0.015701842,
                0.01738139,
                0.0053185755,
                0.029659033,
                0.00033180066,
                -0.011073313,
                0.02355276,
                -0.0051493184,
                0.008879482,
                0.00051957014,
                0.014022291,
                -0.019073961,
                -0.016938718,
                0.0056473245,
                -0.02308405,
                -0.0005309624,
                -0.021690935,
                0.018956782,
                -0.004986571,
                0.021079006,
                0.027966462,
                -0.0072845602,
                0.014334765,
                -0.0065619634,
                -0.0029213105,
                0.0077337427,
                0.016665304,
                0.014517042,
                -0.010858487,
                -0.025089094,
                0.0202197,
                -0.022446081,
                -0.005012611,
                0.0090227,
                0.018865645,
                -0.014464963,
                -0.00903572,
                -0.06572379,
                0.022602318,
                0.01464724,
                -0.003645535,
                -0.00064895407,
                -0.022133606,
                0.0090227,
                0.009536981,
                -0.0057449727,
                0.016144512,
                -0.03304417,
                0.012609646,
                -0.009094308,
                0.010526483,
                -0.0028106426,
                -0.017850103,
                0.011125392,
                -0.022849694,
                -0.0007665389,
                0.011138412,
                0.0029343304,
                -0.015011793,
                0.013052318,
                -0.008736265,
                0.0012238582,
                0.0037789878,
                -0.0028301722,
                0.016470008,
                -0.018409953,
                -0.009491411,
                0.029086163,
                -0.0326015,
                -0.0042607193,
                0.014438923,
                -0.007831391,
                -0.0140483305,
                0.0031800785,
                0.0013296439,
                -0.009699727,
                0.009348194,
                -0.017251194,
                -0.015532584,
                0.023266327,
                -0.017745944,
                -0.009842945,
                0.0036097309,
                -0.0048042946,
                -0.009087798,
                0.0061160363,
                -0.008195944,
                0.013748876,
                0.026052557,
                -0.01068272,
                -0.01740743,
                -0.026039537,
                0.011040764,
                0.025362508,
                -0.011724302,
                -0.0005871102,
                -0.038981188,
                0.009895024,
                0.0004394172,
                0.015832039,
                0.029502796,
                0.018709408,
                0.009237526,
                -0.007831391,
                0.0029961742,
                0.01464724,
                -0.03611684,
                -0.004569939,
                -0.004433231,
                -0.0025909338,
                0.016456988,
                0.019764008,
                0.0036911045,
                -0.0021433793,
                -0.012765883,
                -0.024971915,
                0.025453648,
                0.02075351,
                -0.0053739096,
                -0.024620382,
                -0.0023240286,
                0.013384322,
                0.008137356,
                -0.0038473415,
                0.0022996166,
                -0.01458214,
                0.027133197,
                0.0057221884,
                -0.0014940185,
                0.014230607,
                0.005061435,
                -0.006698671,
                0.013228085,
                -0.01294165,
                0.0058165817,
                0.019243218,
                0.02646919,
                0.01348848,
                0.013332243,
                0.004156561,
                -0.023891276,
                -0.017889163,
                -0.00646757,
                -0.021170143,
                -0.0018618269,
                0.008208964,
                -0.022667417,
                0.0071804025,
                0.018149557,
                0.02368296,
                0.034398228,
                -0.026651466,
                0.01236878,
                0.008241514,
                -0.014126449,
                -0.032861896,
                0.029060123,
                0.020974847,
                -0.0049735517,
                0.023487663,
                -0.0048303343,
                0.021013906,
                -0.011548535,
                0.004000324,
                -0.0084303,
                -0.025115134,
                -0.0011791028,
                -0.005172103,
                0.0014679789,
                -0.015623722,
                -0.014933675,
                -0.006129056,
                0.0034925528,
                -0.0056082653,
                0.029893389,
                -0.0044755456,
                0.035101295,
                0.0050939843,
                -0.011626653,
                0.020519156,
                -0.032419223,
                0.021925291,
                0.024359986,
                -0.0035511418,
                -0.039007228,
                -0.007382209,
                0.0011172589,
                0.0017348841,
                0.0236439,
                -0.025674984,
                -0.007987628,
                -0.017120995,
                -0.009758317,
                -0.016248671,
                -0.015819019,
                0.012440389,
                0.020428017,
                0.0042997785,
                0.0014663514,
                -0.003206118,
                -0.03874683,
                -0.004055658,
                -0.0014785575,
                -0.003196353,
                -0.00843681,
                -0.019347375,
                0.0013548697,
                0.010793388,
                -0.008332652,
                -0.012420859,
                0.014217587,
                0.0002870452,
                -0.0074473075,
                0.0024102847,
                -0.008521439,
                -0.0017625511,
                -0.030414179,
                -0.011568064,
                -0.015701842,
                -0.027706068,
                -0.020115543,
                -0.0018618269,
                -0.0090227,
                -0.0043746424,
                -0.011281629
            ]
        }
    ],
    "model": "ada",
    "usage": {
        "prompt_tokens": 8,
        "total_tokens": 8
    }
}'

-- select @jsonOpenAIEmbeddings


drop table if exists #t;
select
    cast([key] as int) as [vector_value_id],
    cast([value] as float) as [vector_value]
into
	#t
from 
    openjson(@jsonOpenAIEmbeddings, '$.data[0].embedding')

drop table if exists #results;
select top(10)
    v2.Id, 
    sum(v1.[vector_value] * v2.[vector_value]) / 
        (
            sqrt(sum(v1.[vector_value] * v1.[vector_value])) 
            * 
            sqrt(sum(v2.[vector_value] * v2.[vector_value]))
        ) as cosine_distance
into
    #results
from 
    #t v1
inner join 
    dbo.ProjectGutenbergBooksVectorsIndex v2 on v1.vector_value_id = v2.vector_value_id
inner join
	dbo.ProjectGutenbergBooks b1 on b1.Id = v2.Id
group by
    v2.Id
order by
    cosine_distance desc;

select 
    a.Id,
    a.BookTitle,
	a.Author,
	a.Paragraph,
    a.Url,
    r.cosine_distance
from 
    #results r
inner join 
    dbo.ProjectGutenbergBooks a on r.Id = a.Id
order by
    cosine_distance desc;
go