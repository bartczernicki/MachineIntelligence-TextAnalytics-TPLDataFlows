DBCC FREESYSTEMCACHE ('ALL')
DBCC FREEPROCCACHE
DBCC DROPCLEANBUFFERS
SET NOCOUNT ON
SET STATISTICS TIME ON
SET STATISTICS IO ON
go

-- What Did the Raven Say
declare @jsonOpenAIEmbeddings nvarchar(max) = N'{
    "object": "list",
    "data": [
        {
            "object": "embedding",
            "index": 0,
            "embedding": [
                0.006410481,
                -0.025641924,
                -0.0051437193,
                -0.007440558,
                0.024495171,
                0.031869058,
                -0.014947788,
                0.010200765,
                -0.039096266,
                0.0019751482,
                0.017161287,
                0.0034702602,
                -0.03640273,
                0.013694361,
                -0.000096153046,
                0.008080606,
                0.018214699,
                0.021068247,
                0.013814369,
                -0.034829278,
                -0.0023051728,
                0.017681327,
                0.013034311,
                -0.0033569185,
                -0.009047345,
                0.016427899,
                0.017467977,
                -0.01621455,
                0.008347292,
                0.026641998,
                0.006810511,
                0.013921044,
                -0.0020434866,
                -0.018948087,
                -0.017387971,
                -0.022935053,
                0.0019768148,
                0.0022301672,
                0.042109825,
                -0.020601545,
                0.017974682,
                0.0040103006,
                -0.0071338685,
                0.0039936327,
                -0.035736013,
                0.019668141,
                0.015134469,
                -0.0105341235,
                -0.016547907,
                0.010280771,
                0.037282795,
                0.01529448,
                -0.010680801,
                -0.0075072297,
                -0.012494271,
                0.002496854,
                -0.007040528,
                -0.005000375,
                0.010320774,
                -0.0021868306,
                0.006683835,
                -0.011007492,
                -0.013227658,
                0.0011992566,
                -0.018348042,
                0.012674284,
                -0.01141419,
                -0.0058937753,
                -0.013641023,
                0.0017301297,
                0.009660725,
                0.0041269762,
                0.019454792,
                -0.012694285,
                0.015507829,
                -0.047470227,
                -0.033655856,
                0.0032302423,
                -0.025895275,
                0.014107725,
                0.0031119,
                -0.018748073,
                -0.011974231,
                0.031068997,
                0.02120159,
                -0.0042603198,
                0.0013075981,
                0.012787626,
                -0.033149153,
                -0.016894601,
                0.04037636,
                0.031575702,
                -0.0018668066,
                0.006840513,
                -0.0089940075,
                0.0028785493,
                -0.032935802,
                0.020641549,
                0.0078939255,
                -0.022121659,
                0.0066771675,
                0.0024835195,
                -0.036456067,
                -0.0065004877,
                0.009700728,
                0.0018851414,
                -0.009940745,
                -0.005983782,
                0.02148161,
                0.0010392446,
                -0.017868007,
                0.012947638,
                0.015427824,
                -0.006760507,
                0.0043169903,
                -0.03538932,
                0.005850439,
                -0.014961123,
                -0.010727472,
                -0.016641248,
                0.010387446,
                0.02569526,
                0.00074755604,
                -0.013894375,
                0.011320849,
                -0.0020901568,
                0.006280471,
                0.009520714,
                -0.01569451,
                -0.0051337183,
                0.028855497,
                -0.012334258,
                0.013854372,
                0.0034202565,
                -0.017174622,
                0.016254552,
                -0.039096266,
                0.011434191,
                -0.0042603198,
                -0.04336325,
                -0.011694211,
                0.030242268,
                -0.011807553,
                0.0028852164,
                -0.025148552,
                0.015281146,
                0.01809469,
                -0.0025435241,
                0.0042503187,
                0.0039502964,
                0.0095273815,
                0.020961571,
                0.0007983932,
                -0.023721779,
                0.008047271,
                0.014374412,
                -0.003743614,
                0.00094673765,
                -0.02110825,
                -0.019788152,
                0.008894,
                0.026308639,
                0.017267961,
                -0.0012467601,
                0.01294097,
                0.015241143,
                0.0071338685,
                0.01840138,
                -0.011820886,
                -0.00054879114,
                -0.016041202,
                0.009547383,
                -0.04144311,
                0.017134618,
                0.027268711,
                0.011720879,
                0.006367144,
                -0.030508954,
                -0.0003673192,
                -0.027042028,
                -0.022695035,
                0.018241368,
                0.018428048,
                0.031575702,
                -0.03202907,
                0.014174396,
                0.008453967,
                -0.009287363,
                0.008213949,
                -0.010394113,
                0.023281746,
                0.03877624,
                0.007040528,
                -0.030988991,
                -0.6391946,
                -0.01969481,
                -0.022548357,
                0.016787926,
                0.016067872,
                0.024428498,
                0.0087473225,
                0.0061737965,
                -0.004386996,
                0.0023135068,
                -0.02202832,
                0.008907335,
                0.009800735,
                0.018628065,
                -0.010167429,
                -0.007313882,
                0.012267587,
                -0.0048370296,
                0.005527081,
                0.021454943,
                -0.0065404903,
                0.029308865,
                0.00960072,
                -0.008507305,
                -0.001528448,
                0.013987715,
                0.005073714,
                -0.020828228,
                -0.029522214,
                0.0058371043,
                -0.017961347,
                0.025041878,
                -0.022921719,
                -0.009867406,
                0.04824362,
                -0.0030502288,
                -0.014654432,
                0.048350293,
                -0.0082539525,
                0.0018734739,
                -0.008433966,
                -0.024455167,
                -0.0074805613,
                -0.002423515,
                -0.0028135444,
                0.005297064,
                0.0111075,
                0.021454943,
                -0.028428799,
                0.0014659433,
                -0.00045128385,
                0.029362202,
                -0.02280171,
                0.011854222,
                -0.016841263,
                -0.0067805084,
                0.0039002926,
                -0.013140986,
                -0.0009867407,
                0.009440708,
                -0.023575101,
                0.023961797,
                0.009727396,
                -0.017774666,
                0.0029518881,
                0.011607537,
                0.0028935503,
                0.032882467,
                0.013220992,
                -0.006920519,
                0.003143569,
                0.028295456,
                -0.023761783,
                0.009027344,
                0.015801186,
                0.013214325,
                -0.007967264,
                0.007313882,
                -0.0045403405,
                -0.009067346,
                0.016614579,
                -0.0038302874,
                -0.040296357,
                0.004743689,
                0.043869957,
                -0.0064471504,
                -0.034722604,
                -0.0029402205,
                0.0070671965,
                -0.013327667,
                0.014054388,
                0.033549182,
                -0.021028243,
                -0.007487228,
                -0.010460785,
                0.0111608375,
                -0.006873849,
                0.010834146,
                0.0042536524,
                -0.043149903,
                0.012947638,
                -0.01990816,
                0.02440183,
                -0.0013509346,
                0.015707845,
                -0.0020368195,
                -0.007827254,
                0.00760057,
                0.017387971,
                -0.021654958,
                0.0022618363,
                -0.005663758,
                0.0074138893,
                -0.019974831,
                -0.011474194,
                -0.028855497,
                0.041336432,
                0.009387371,
                0.01621455,
                -0.041629788,
                0.012280921,
                0.026108624,
                0.00066713337,
                -0.026815344,
                0.007940596,
                0.017788,
                0.010114091,
                -0.030242268,
                -0.014067722,
                0.021094915,
                0.004313657,
                -0.011454192,
                0.032935802,
                -0.02960222,
                0.013054312,
                -0.012207583,
                0.02722871,
                -0.0160012,
                0.0035469327,
                0.008673984,
                -0.0062738038,
                0.0031002325,
                0.011234176,
                -0.00440033,
                -0.011727546,
                -0.01941479,
                -0.009094016,
                -0.009947413,
                -0.04018968,
                0.023575101,
                0.010834146,
                0.0061737965,
                -0.020534873,
                0.002536857,
                -0.0061037913,
                -0.0008633981,
                -0.015867857,
                0.00084923033,
                0.005550416,
                0.015627839,
                0.01572118,
                0.015894525,
                -0.024361826,
                0.010247435,
                0.014787775,
                -0.017854672,
                0.013347668,
                0.012114242,
                -0.018081356,
                -0.026842013,
                0.010680801,
                -0.021401605,
                -0.010714137,
                0.0021068247,
                -0.0023635107,
                -0.023135068,
                0.00008396463,
                -0.0066538323,
                -0.016467901,
                -0.008213949,
                -0.006120459,
                0.013140986,
                -0.0027318716,
                -0.0025701928,
                0.0134410085,
                0.010374111,
                0.021348268,
                -0.00016376228,
                0.019654807,
                0.009020677,
                -0.011474194,
                0.014454418,
                0.015614504,
                0.005263728,
                0.003720279,
                -0.012880966,
                0.01920144,
                -0.0009925745,
                -0.0062904716,
                0.014961123,
                0.032722455,
                0.0012667617,
                0.03133568,
                -0.014281071,
                -0.0009234026,
                -0.031682376,
                0.016374562,
                -0.0073005473,
                0.015681176,
                -0.00010969573,
                0.018868081,
                -0.025161887,
                -0.0077539147,
                -0.014267737,
                0.033869207,
                0.019121435,
                0.0015367819,
                -0.009540715,
                -0.00955405,
                -0.005263728,
                -0.018254703,
                -0.016721254,
                0.00087089866,
                0.008833996,
                -0.01938812,
                0.002718537,
                0.005463743,
                -0.0022618363,
                0.005190389,
                -0.009820737,
                0.00038877915,
                0.0037069446,
                0.0038469553,
                0.013427674,
                0.011220842,
                -0.01560117,
                -0.0023868456,
                -0.00809394,
                0.020148179,
                -0.029708894,
                -0.0087673245,
                0.015801186,
                0.0048670317,
                -0.015827853,
                0.020694885,
                0.008047271,
                0.021068247,
                0.03042895,
                0.007887258,
                0.009387371,
                0.010480786,
                -0.0004612846,
                -0.00012855131,
                0.010254103,
                0.0074072224,
                -0.021881642,
                0.0012734288,
                0.0007979765,
                0.0010109091,
                0.024908535,
                -0.013020976,
                -0.013381003,
                0.010200765,
                0.001896809,
                0.016161213,
                0.005667092,
                -0.0039402954,
                -0.011820886,
                0.005440408,
                -0.015587836,
                0.017627988,
                -0.001183422,
                0.011887558,
                0.007573901,
                0.013921044,
                -0.02030819,
                0.008900668,
                0.014281071,
                0.0068938504,
                0.0121675795,
                0.0038602895,
                -0.028722154,
                0.034455918,
                0.021801636,
                -0.014347742,
                -0.007760582,
                -0.00038877915,
                0.00094757107,
                -0.006370478,
                0.029308865,
                0.03320249,
                0.017534649,
                -0.00470702,
                -0.020628214,
                0.012380929,
                -0.02040153,
                0.018548058,
                -0.004063638,
                0.037496146,
                -0.013547683,
                0.003800285,
                -0.0022535024,
                -0.021001576,
                -0.04117642,
                0.00067213376,
                -0.0023885125,
                -0.015854523,
                -0.015534499,
                -0.022201665,
                -0.014534423,
                -0.014481086,
                0.01729463,
                -0.029068846,
                -0.026628664,
                0.0036969439,
                0.04024302,
                -0.017414639,
                0.023308415,
                0.024188481,
                0.029095516,
                -0.006067122,
                -0.014841113,
                -0.020361528,
                0.009007342,
                0.15606503,
                0.036082707,
                0.009974081,
                0.007013859,
                0.028082106,
                -0.0056770924,
                -0.016347893,
                -0.017948013,
                0.032322425,
                -0.00091673544,
                -0.014574426,
                0.00035252643,
                -0.011547533,
                0.031895727,
                0.0104007805,
                -0.0034735939,
                0.001696794,
                0.0010025752,
                0.009454043,
                -0.022481686,
                0.0033719195,
                -0.013707695,
                -0.007187206,
                0.011927561,
                -0.02169496,
                -0.009267362,
                -0.007513897,
                0.007787251,
                0.005720429,
                -0.00069713563,
                -0.015867857,
                0.0064304825,
                0.00034148394,
                0.021348268,
                -0.0032835796,
                -0.023828454,
                -0.0080072675,
                -0.0025001876,
                0.014614429,
                -0.020161511,
                0.027162038,
                0.005183722,
                0.008080606,
                0.0049737063,
                0.021614954,
                0.005727096,
                -0.014974456,
                0.008293956,
                -0.0015334483,
                -0.027308716,
                0.05861773,
                0.01336767,
                -0.0016701253,
                0.007827254,
                0.0016876266,
                0.016854597,
                -0.0017951346,
                -0.013147653,
                -0.011087499,
                0.062351342,
                -0.01400105,
                -0.02609529,
                0.006880516,
                -0.018388046,
                -0.017988015,
                -0.022428349,
                -0.023455093,
                -0.006193798,
                0.0026768674,
                -0.029388871,
                -0.0011217508,
                -0.03301581,
                -0.008673984,
                0.0012384262,
                0.02510855,
                0.022815045,
                0.008987341,
                -0.024868531,
                0.0046436815,
                0.017734664,
                -0.020854898,
                0.00011188339,
                -0.0018351376,
                -0.017627988,
                -0.00537707,
                -0.00875399,
                0.015067797,
                -0.016481236,
                -0.02508188,
                0.010220767,
                0.0040269685,
                0.029655557,
                0.0064504836,
                -0.011967564,
                -0.009587386,
                0.010634131,
                -0.031655706,
                -0.0029152187,
                -0.017174622,
                0.00941404,
                0.015961196,
                -0.021054912,
                -0.0017001275,
                -0.003663608,
                -0.016481236,
                0.011700878,
                -0.004333658,
                -0.0386429,
                -0.020974906,
                0.010434116,
                0.031175671,
                -0.014521089,
                -0.004833696,
                0.00032731623,
                0.019801484,
                0.00035377653,
                0.0077539147,
                0.015827853,
                -0.004096974,
                -0.0052037234,
                0.01668125,
                -0.020041503,
                0.015747847,
                0.013734363,
                -0.0038636231,
                0.036482736,
                0.0015909526,
                -0.027682075,
                -0.000071255345,
                -0.009074014,
                -0.00062838045,
                0.003543599,
                0.0048536975,
                -0.029095516,
                -0.02508188,
                -0.000915902,
                0.007233876,
                0.0018784743,
                -0.0124142645,
                0.0063638105,
                -0.026682,
                0.011547533,
                -0.011067497,
                -0.01529448,
                -0.025188556,
                -0.02670867,
                -0.0031802384,
                0.009300698,
                -0.02520189,
                0.022148328,
                -0.025015209,
                0.025281897,
                -0.004663683,
                -0.001096749,
                0.0048703654,
                -0.05027044,
                0.006673834,
                0.0044103307,
                0.023175072,
                0.0053437343,
                0.043843288,
                -0.0082539525,
                0.021961648,
                -0.000102455604,
                -0.0054137395,
                -0.013320999,
                -0.010234101,
                -0.01668125,
                -0.014041053,
                0.009947413,
                0.014254402,
                0.0074938955,
                0.027468726,
                0.018694736,
                -0.01084748,
                0.0036036037,
                -0.013867707,
                -0.0071405354,
                -0.004703686,
                -0.016841263,
                -0.009420707,
                -0.0062738038,
                -0.020028168,
                -0.0057804333,
                -0.011827554,
                -0.014147728,
                0.0007317215,
                -0.003088565,
                0.008413964,
                -0.026228635,
                0.023721779,
                -0.010300772,
                0.018441383,
                -0.00065129885,
                -0.016921269,
                -0.0050670467,
                0.004016968,
                0.0074072224,
                0.01960147,
                -0.002728538,
                0.011127501,
                0.015267812,
                -0.014881116,
                0.019534798,
                -0.0028918835,
                0.045096714,
                0.0075805685,
                0.007013859,
                0.02962889,
                -0.005167054,
                -0.028295456,
                -0.018654732,
                -0.03664275,
                -0.04277654,
                0.0028202115,
                -0.006370478,
                -0.010640798,
                0.00760057,
                -0.007013859,
                -0.019374786,
                -0.03000225,
                -0.014481086,
                0.03304248,
                0.0462168,
                0.021921644,
                -0.0039069597,
                -0.010340775,
                -0.0029085514,
                0.01882808,
                0.00090590125,
                0.011320849,
                0.009620721,
                0.019868156,
                -0.008840663,
                0.0010709136,
                -0.0051437193,
                -0.00038190364,
                -0.026682,
                -0.015334483,
                0.018294705,
                0.0064471504,
                -0.013694361,
                -0.0024618513,
                -0.008427299,
                0.008027269,
                -0.0011250844,
                -0.010954155,
                -0.014827779,
                -0.009847405,
                0.007080531,
                -0.027362052,
                -0.03400255,
                0.007907259,
                0.028108776,
                -0.015854523,
                -0.0021951646,
                0.008513972,
                -0.0016476236,
                0.00840063,
                0.00033481678,
                -0.01760132,
                0.016841263,
                0.0074605597,
                0.008693986,
                -0.004963706,
                -0.005850439,
                -0.00062338007,
                -0.016974606,
                -0.003176905,
                0.023241743,
                0.01320099,
                0.01566784,
                0.010154095,
                0.006823845,
                0.010487453,
                -0.006583827,
                0.0047136866,
                0.0026768674,
                0.022281671,
                -0.021574952,
                0.016347893,
                0.027242044,
                -0.013300997,
                -0.00915402,
                -0.006413814,
                -0.019174771,
                -0.016147878,
                -0.023735113,
                -0.0018818078,
                0.0032119076,
                -0.019228108,
                -0.026935354,
                -0.020068172,
                0.019788152,
                -0.0054270737,
                -0.02282838,
                -0.016467901,
                0.0018201366,
                -0.023628438,
                -0.0153211495,
                -0.022681702,
                0.0055870856,
                -0.015374486,
                0.009947413,
                -0.002591861,
                0.008287288,
                0.035842687,
                0.008240618,
                -0.0066905017,
                -0.013167654,
                0.009654057,
                -0.015627839,
                0.012420932,
                -0.015174472,
                0.027948763,
                -0.01840138,
                -0.005437074,
                0.00995408,
                -0.014321074,
                0.024295155,
                -0.0012950972,
                0.0075005624,
                0.017974682,
                -0.030455617,
                0.0041069747,
                0.014907785,
                -0.0001591786,
                -0.0008792326,
                -0.027682075,
                -0.016867932,
                0.008273954,
                0.0068471804,
                -0.019481461,
                -0.026668666,
                -0.012554275,
                -0.009614054,
                -0.019561468,
                0.02470852,
                -0.008433966,
                0.014241068,
                0.008247285,
                0.007747248,
                0.010247435,
                -0.00031648207,
                -0.0015509496,
                0.0062738038,
                0.0042836545,
                -0.013394338,
                -0.03133568,
                -0.02680201,
                -0.019041428,
                0.03178905,
                -0.015881192,
                -0.028882166,
                -0.018188031,
                0.017467977,
                -0.034775943,
                -0.016694585,
                -0.00048711986,
                0.019854823,
                0.015827853,
                0.007787251,
                0.007960597,
                0.01809469,
                0.007713912,
                0.031149004,
                -0.029735563,
                -0.0030118925,
                0.017734664,
                -0.011300848,
                0.013521014,
                0.004737022,
                -0.008853997,
                0.003720279,
                -0.017667992,
                0.0053270664,
                0.011980899,
                0.011167504,
                -0.036349393,
                -0.018574726,
                -0.024988541,
                -0.004790359,
                -0.0082539525,
                0.010540791,
                0.0022701703,
                -0.007793918,
                -0.003336917,
                0.004183647,
                0.0008542307,
                -0.033922546,
                -0.012340926,
                0.033522513,
                0.004346993,
                0.014681101,
                -0.008980674,
                -0.0055304146,
                -0.016747924,
                0.008467302,
                0.02021485,
                -0.025548583,
                -0.008447301,
                0.022788376,
                -0.0012809294,
                -0.016507905,
                0.016321223,
                0.039576303,
                -0.018214699,
                -0.038136195,
                -0.00072713784,
                -0.0058037685,
                -0.00024564343,
                -0.0035902692,
                -0.004230317,
                -0.007013859,
                -0.019481461,
                -0.0010809144,
                0.005177055,
                -0.010554125,
                0.0012409264,
                -0.0015326149,
                -0.00866065,
                0.021628289,
                -0.011480861,
                -0.0052137244,
                -0.017854672,
                -0.0065338234,
                0.011060829,
                -0.011587536,
                0.0039569633,
                0.018708069,
                -0.010680801,
                -0.0026368643,
                0.020774892,
                0.0031519032,
                0.009700728,
                0.006067122,
                0.23937796,
                -0.020241518,
                -0.016894601,
                0.037442807,
                -0.008787326,
                0.00884733,
                0.027162038,
                0.0131543195,
                -0.009494046,
                -0.0013834371,
                -0.008393963,
                0.018014684,
                -0.015681176,
                0.0022285006,
                -0.0013034311,
                -0.014747772,
                -0.024148477,
                -0.055684175,
                -0.008467302,
                -0.02218833,
                0.0074672266,
                0.023988467,
                0.00000683645,
                -0.019868156,
                0.02070822,
                0.00042878216,
                -0.005697094,
                -0.007820587,
                0.00057212624,
                0.017254628,
                -0.013187656,
                -0.0090140095,
                -0.019654807,
                0.010760807,
                0.009240693,
                -0.0032035736,
                0.0042769876,
                -0.0065971613,
                0.01000075,
                0.01969481,
                0.0019001425,
                0.008107275,
                -0.011987566,
                0.0039236275,
                0.010640798,
                -0.01120084,
                -0.0074538924,
                -0.015774516,
                -0.014147728,
                0.012534274,
                -0.022948388,
                -0.027922094,
                0.01141419,
                0.017334633,
                0.0044136643,
                -0.013320999,
                0.0150544625,
                0.027495395,
                -0.03885625,
                -0.023241743,
                -0.002480186,
                0.020868232,
                -0.011060829,
                0.024535174,
                0.0053137317,
                0.032535773,
                -0.038696237,
                0.002145161,
                -0.0102874385,
                -0.016347893,
                -0.00582377,
                -0.00020543208,
                0.017988015,
                -0.01969481,
                0.0024368495,
                -0.03181572,
                0.025535248,
                -0.016321223,
                0.017881341,
                0.02298839,
                -0.019308114,
                0.009314032,
                0.0013701027,
                -0.020788226,
                -0.010014084,
                -0.030188931,
                0.0021634956,
                -0.00021751631,
                -0.0014867781,
                -0.012200915,
                0.013054312,
                -0.019574802,
                -0.0053470675,
                0.019534798,
                0.017161287,
                0.014681101,
                -0.008680651,
                0.02122826,
                -0.004447,
                -0.003990299,
                -0.031655706,
                -0.009700728,
                0.004663683,
                -0.015134469,
                -0.021494946,
                0.010934154,
                0.0020301524,
                0.022921719,
                0.026161961,
                -0.02101491,
                -0.009794068,
                -0.009040678,
                0.010200765,
                -0.008307289,
                0.022094991,
                0.021494946,
                0.012587611,
                -0.0030068923,
                0.02061488,
                -0.024521839,
                -0.0035736014,
                -0.016481236,
                -0.004423665,
                0.019974831,
                -0.0040203016,
                -0.0022935052,
                -0.005160387,
                0.0114075225,
                -0.012880966,
                -0.022601696,
                0.017067946,
                -0.006360477,
                0.014014385,
                -0.027068697,
                -0.0008338125,
                0.006920519,
                0.027655408,
                -0.042056486,
                -0.011980899,
                -0.010640798,
                0.01858806,
                -0.00040669716,
                0.01941479,
                0.012740956,
                0.018148027,
                -0.015707845,
                0.022255002,
                -0.016561242,
                0.0015784517,
                -0.024735188,
                -0.035122633,
                -0.009054013,
                -0.010300772,
                -0.016454568,
                0.014334409,
                -0.011120834,
                0.0063038063,
                -0.015027794,
                0.010680801,
                0.0023301747,
                -0.01861473,
                0.007440558,
                0.020694885,
                -0.006513822,
                -0.00275354,
                0.0005146219,
                -0.17025277,
                0.011720879,
                0.009160687,
                -0.01833471,
                0.032242417,
                0.013561017,
                0.0062904716,
                0.0049270364,
                -0.027682075,
                0.02428182,
                0.017841337,
                0.014681101,
                -0.035922695,
                -0.0074938955,
                0.0134210065,
                0.027548732,
                -0.008540641,
                -0.0027152037,
                0.019588135,
                0.013774366,
                0.03320249,
                -0.0014867781,
                0.011280846,
                0.0019701477,
                0.005510413,
                -0.008220617,
                -0.024228483,
                0.023921793,
                -0.01828137,
                -0.010994158,
                -0.027548732,
                -0.0019051429,
                0.022575026,
                -0.00039732148,
                0.016174546,
                0.0042536524,
                0.020948239,
                -0.016734589,
                -0.015614504,
                0.008760657,
                0.016907934,
                0.043896627,
                0.015134469,
                0.013167654,
                -0.012367594,
                0.012654282,
                0.010860815,
                0.027842088,
                -0.018228034,
                -0.006840513,
                0.009047345,
                -0.024415165,
                0.055204142,
                -0.0077739162,
                0.0036902768,
                0.044216648,
                0.003120234,
                0.0062238,
                0.0077539147,
                -0.0074605597,
                -0.0050037084,
                -0.025428575,
                0.026508655,
                -0.009067346,
                -0.01480111,
                0.016827928,
                -0.011060829,
                -0.011627539,
                -0.0031552366,
                0.01390771,
                -0.014547758,
                -0.0231084,
                0.020694885,
                0.0010467452,
                0.010060755,
                -0.00041461442,
                0.00074297236,
                -0.0008421465,
                -0.00083256245,
                -0.005657091,
                -0.03698944,
                0.027868757,
                -0.023961797,
                0.011280846,
                -0.008273954,
                0.00029523048,
                0.02150828,
                -0.004143644,
                -0.004313657,
                -0.003616938,
                -0.0010809144,
                -0.025068548,
                -0.00072255416,
                -0.0417898,
                0.012040903,
                0.016281221,
                0.0045970115,
                -0.002473519,
                -0.0034902617,
                -0.029255528,
                -0.015921194,
                -0.0023718446,
                0.0013384337,
                0.032189082,
                0.03661608,
                0.011134168,
                -0.015014459,
                0.002215166,
                0.041709796,
                -0.020041503,
                -0.017441308,
                -0.010654133,
                0.051950563,
                0.023575101,
                -0.005850439,
                0.028935503,
                -0.0058371043,
                -0.024748523,
                0.03402922,
                -0.020694885,
                0.0688585,
                0.009427373,
                0.019801484,
                0.006553825,
                -0.0074538924,
                0.009987416,
                -0.08976673,
                -0.033149153,
                -0.017614655,
                0.00033252494,
                0.014374412,
                0.0042536524,
                0.0071405354,
                -0.027042028,
                0.0015067797,
                0.012114242,
                0.006513822,
                -0.029522214,
                0.0045970115,
                -0.009974081,
                0.024908535,
                -0.00093507016,
                0.026388645,
                -0.03178905,
                -0.017347967,
                -0.011867557,
                0.00030648132,
                -0.0056037535,
                0.0012225917,
                -0.013254328,
                0.007360552,
                -0.032855798,
                -0.027735414,
                0.023468427,
                0.018748073,
                0.0066638333,
                0.011754215,
                -0.023975132,
                -0.0060904566,
                -0.01400105,
                0.004993708,
                -0.006217133,
                -0.015241143,
                0.0030685635,
                0.0024918537,
                -0.06181797,
                0.026175296,
                0.016054537,
                0.0005129551,
                -0.032242417,
                -0.020801561,
                -0.00082964555,
                -0.015467827,
                0.020014834,
                0.034882616,
                0.0036102708,
                -0.024668517,
                -0.008420631,
                -0.020948239,
                0.0028585477,
                0.0324291,
                -0.009687393,
                -0.0033752532,
                0.02882883,
                -0.023855122,
                -0.027215375,
                -0.024961872,
                -0.010760807,
                -0.018934753,
                -0.01430774,
                -0.0027302047,
                0.015014459,
                0.02520189,
                -0.0007613071,
                0.0231084,
                -0.0041269762,
                -0.008367294,
                0.021894975,
                -0.003760282,
                0.005353735,
                0.0006217133,
                0.019774817,
                -0.0110274935,
                -0.007313882,
                0.008453967,
                -0.024935203,
                0.004673684,
                -0.021868307,
                0.0262153,
                -0.001151753,
                0.023881791,
                0.027215375,
                -0.0039802985,
                0.007973932,
                0.0012600945,
                -0.00058796076,
                0.0032902467,
                0.021868307,
                0.014587761,
                -0.011874224,
                -0.01993483,
                0.02692202,
                -0.021361602,
                -0.0102674365,
                0.015227809,
                0.01270762,
                -0.008853997,
                -0.0053003975,
                -0.067578405,
                0.02280171,
                0.012214249,
                -0.00027814586,
                0.008300623,
                -0.022881716,
                0.02092157,
                0.005363736,
                -0.0007258878,
                0.02550858,
                -0.031175671,
                0.013347668,
                -0.021734964,
                0.010914152,
                0.0015567834,
                -0.013007643,
                0.007960597,
                -0.02640198,
                -0.0038202866,
                0.012900967,
                0.0050103758,
                -0.01520114,
                0.017534649,
                -0.0035736014,
                0.0017317965,
                0.0072138743,
                -0.000054066553,
                0.017561316,
                -0.022441683,
                -0.013774366,
                0.035255976,
                -0.026415315,
                -0.0033485845,
                0.0102674365,
                -0.005713762,
                -0.005250394,
                0.00382362,
                -0.005617088,
                -0.012094241,
                0.012920969,
                -0.010714137,
                -0.02092157,
                0.026175296,
                -0.02698869,
                -0.012740956,
                0.00025085214,
                -0.009914077,
                -0.010107425,
                0.005450409,
                -0.019281447,
                0.0095273815,
                0.02190831,
                -0.01195423,
                -0.021281596,
                -0.02562859,
                0.0050037084,
                0.021881642,
                -0.011994233,
                0.0019134769,
                -0.041709796,
                0.0037069446,
                0.003943629,
                0.013947713,
                0.030562293,
                0.018468052,
                0.0078939255,
                -0.0077005774,
                0.010487453,
                0.012814295,
                -0.038696237,
                -0.010520789,
                0.0028118775,
                0.0028585477,
                0.014721104,
                0.017547984,
                0.008440633,
                0.0034235902,
                -0.017654657,
                -0.023041729,
                0.026268637,
                0.014534423,
                -0.011794218,
                -0.026161961,
                -0.005970448,
                0.014027718,
                0.0011417523,
                -0.0030502288,
                -0.008580644,
                -0.016161213,
                0.021788301,
                0.020108175,
                -0.004647015,
                0.0011967564,
                -0.00360027,
                -0.008807328,
                0.0017067947,
                -0.014267737,
                0.0009742397,
                0.012100908,
                0.035869356,
                0.010487453,
                0.019241443,
                0.010907485,
                -0.031309016,
                -0.01849472,
                -0.0043536597,
                -0.021828303,
                -0.00013042644,
                0.015041128,
                -0.026055288,
                0.007847255,
                0.028402131,
                0.008894,
                0.036936104,
                -0.024948537,
                0.0107808085,
                -0.004463668,
                -0.018534724,
                -0.031735715,
                0.032189082,
                0.022961723,
                -0.0062204665,
                0.02741539,
                -0.0034235902,
                0.024215149,
                -0.0070671965,
                0.007473894,
                -0.018721404,
                -0.025841938,
                0.00029502212,
                -0.0038869581,
                0.0059404457,
                -0.014507755,
                -0.018508054,
                -0.0049103685,
                0.0023901793,
                -0.0031719045,
                0.025268562,
                -0.012487603,
                0.02861548,
                0.005910443,
                -0.0069805235,
                0.02360177,
                -0.03296247,
                0.027148703,
                0.029148852,
                -0.0051470525,
                -0.04699019,
                0.00049628725,
                0.008340625,
                -0.0010825812,
                0.033122484,
                -0.023668442,
                -0.0077272463,
                -0.012980973,
                -0.004990374,
                -0.0127942925,
                -0.017494645,
                0.004256986,
                0.0077739162,
                -0.00058462715,
                0.011174171,
                -0.0032869133,
                -0.038349543,
                0.003623605,
                0.005183722,
                -0.006810511,
                -0.011807553,
                -0.022081656,
                0.006263803,
                0.015267812,
                -0.017374637,
                -0.018508054,
                0.013314332,
                -0.01294097,
                -0.0047003524,
                -0.004760357,
                -0.0038102858,
                -0.0060471203,
                -0.037416138,
                -0.017241294,
                -0.016294556,
                -0.02981557,
                -0.018974757,
                -0.0120009,
                -0.0056904266,
                -0.0062037986,
                -0.0087673245
            ]
        }
    ],
    "model": "text-embedding-ada-002-v2",
    "usage": {
        "prompt_tokens": 9,
        "total_tokens": 9
    }
}'

-- select @jsonOpenAIEmbeddings


drop table if exists #t;
select
    cast([key] as int) as [vector_value_id],
    cast([value] as float) as [vector_value]
into
	#t
from 
    openjson(@jsonOpenAIEmbeddings, '$.data[0].embedding')

drop table if exists #results;
select top(10)
    v2.Id, 
    sum(v1.[vector_value] * v2.[vector_value]) / 
        (
            sqrt(sum(v1.[vector_value] * v1.[vector_value])) 
            * 
            sqrt(sum(v2.[vector_value] * v2.[vector_value]))
        ) as cosine_distance
into
    #results
from 
    #t v1
inner join 
    dbo.ProjectGutenbergBooksVectorsIndex v2 on v1.vector_value_id = v2.vector_value_id
inner join
	dbo.ProjectGutenbergBooks b1 on b1.Id = v2.Id
where
	b1.BookTitle = 'An Ideal Husband'
group by
    v2.Id
order by
    cosine_distance desc;

select 
    a.Id,
    a.BookTitle,
	a.Author,
	a.Paragraph,
    a.Url,
    r.cosine_distance
from 
    #results r
inner join 
    dbo.ProjectGutenbergBooks a on r.Id = a.Id
order by
    cosine_distance desc;
go