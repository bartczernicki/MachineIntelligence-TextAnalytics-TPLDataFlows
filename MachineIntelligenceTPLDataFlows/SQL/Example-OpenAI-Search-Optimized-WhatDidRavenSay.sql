DBCC FREESYSTEMCACHE ('ALL')
DBCC FREEPROCCACHE
DBCC DROPCLEANBUFFERS
SET NOCOUNT ON
SET STATISTICS TIME ON
SET STATISTICS IO ON
go

-- What Did the Raven Say
declare @jsonExample1 nvarchar(max) = N'{
    "object": "list",
    "data": [
        {
            "object": "embedding",
            "index": 0,
            "embedding": [
                0.0011823545,
                -0.026630456,
                0.00044711216,
                0.013666951,
                -0.0069151255,
                -0.008001698,
                0.00062297366,
                -0.044618573,
                -0.016631473,
                -0.01390562,
                0.031705316,
                -0.00031639368,
                0.0033759128,
                -0.035699885,
                -0.0033821934,
                -0.008303175,
                0.028866408,
                -0.0029896456,
                0.025927009,
                -0.015777288,
                -0.005131387,
                0.006726702,
                0.0022752082,
                -0.025261248,
                -0.023866918,
                -0.0037841627,
                0.02298761,
                -0.012417078,
                0.032182653,
                -0.0064503485,
                0.029318623,
                -0.0054077413,
                -0.014144289,
                -0.01890511,
                -0.043136314,
                -0.015362758,
                -0.008416229,
                -0.0032597184,
                0.02086471,
                -0.01570192,
                0.022397218,
                -0.0016408506,
                0.003076006,
                0.009132236,
                -0.0151492115,
                0.0027446956,
                -0.0041610086,
                -0.0015858939,
                -0.000052503292,
                0.023427265,
                0.018176543,
                -0.017623834,
                -0.022346972,
                -0.018214226,
                0.0049932105,
                0.022937365,
                -0.007273129,
                0.020688849,
                0.005963589,
                0.0013024742,
                0.02413071,
                -0.0077504674,
                0.0032188934,
                -0.0039694454,
                0.014521135,
                0.012530132,
                0.010099474,
                -0.023866918,
                -0.029921578,
                -0.007329656,
                0.03690579,
                -0.0017036583,
                0.007624852,
                -0.0018905111,
                0.0024557803,
                0.004867595,
                -0.0029912156,
                -0.0131644895,
                -0.009188763,
                -0.015249704,
                0.014458328,
                -0.014357835,
                -0.025726024,
                0.015676796,
                -0.0015450689,
                -0.0067455447,
                0.003931761,
                0.022158548,
                -0.03147921,
                0.005439145,
                -0.0095279245,
                0.014960789,
                0.0031262522,
                0.016179258,
                0.010539128,
                0.024469871,
                0.011594297,
                0.02371618,
                -0.012391955,
                -0.004352572,
                0.007945172,
                0.0100115435,
                -0.022321848,
                -0.010017824,
                -0.009797998,
                -0.0067455447,
                -0.01308912,
                0.0047419798,
                0.025411986,
                -0.015965711,
                -0.008397386,
                0.030323546,
                0.016857581,
                -0.055270758,
                0.0055584796,
                0.004949245,
                0.012140724,
                -0.009559329,
                -0.0067832293,
                -0.019407572,
                0.017900188,
                -0.0025609832,
                0.015186897,
                -0.0018151419,
                -0.0014712699,
                0.009521644,
                -0.010532848,
                0.003608301,
                -0.011116959,
                -0.0053260913,
                0.020877272,
                0.016493296,
                0.010451198,
                0.00094368536,
                -0.02462061,
                0.019281957,
                -0.008485317,
                0.020010525,
                0.0034669838,
                -0.00638126,
                -0.013604143,
                0.009804279,
                -0.0032345955,
                0.0028530387,
                0.007706502,
                0.028263455,
                0.02404278,
                -0.0061394507,
                0.0017334919,
                -0.019269396,
                0.034117132,
                0.0076436945,
                0.015651673,
                -0.026052624,
                0.0077504674,
                0.010576813,
                -0.0011250426,
                0.014985912,
                -0.0118706515,
                -0.0055302163,
                0.0006104121,
                0.022183672,
                0.03934273,
                -0.01104159,
                -0.0025845359,
                0.03670481,
                0.046151083,
                -0.006283908,
                -0.024319133,
                0.0050937026,
                -0.015086404,
                0.014094043,
                -0.03009744,
                0.031127485,
                -0.00907571,
                0.01537532,
                -0.0013699925,
                -0.0011062003,
                -0.021869633,
                -0.00023631389,
                -0.0050183334,
                0.02331421,
                0.015199458,
                0.020475304,
                -0.008322017,
                -0.017159058,
                0.014445766,
                -0.014257343,
                0.013038874,
                -0.012247497,
                0.005988712,
                -0.002681888,
                0.0036334242,
                -0.023138348,
                -0.67932785,
                -0.035297915,
                0.01521202,
                -0.00400713,
                0.033639792,
                0.007386183,
                0.013842812,
                0.01619182,
                0.002510737,
                0.022610765,
                0.0068271947,
                -0.010068071,
                -0.008786794,
                -0.011581736,
                -0.006808352,
                -0.012209812,
                0.0007540847,
                -0.0010598795,
                -0.00801426,
                -0.0021040572,
                -0.041427944,
                0.032860976,
                0.0022940505,
                -0.013013751,
                -0.010746393,
                0.024344256,
                0.009370905,
                0.0013535054,
                -0.015325073,
                -0.012253778,
                -0.034770332,
                0.022485148,
                0.007624852,
                0.006173995,
                0.03886539,
                0.0011305382,
                -0.010017824,
                0.023201156,
                0.006192837,
                0.042734344,
                0.006208539,
                0.0015780429,
                0.0041264645,
                0.007631133,
                -0.0044530644,
                -0.0138553735,
                0.018063487,
                0.004280343,
                0.0005597734,
                0.0076625366,
                0.0049366835,
                -0.009377186,
                0.00932694,
                0.007681379,
                0.00343558,
                -0.00065045204,
                0.032534376,
                0.007530641,
                -0.024218641,
                0.0074803946,
                -0.020437619,
                0.020349687,
                -0.0014532127,
                0.01161314,
                -0.00973519,
                0.010922255,
                0.0070972675,
                0.012938382,
                0.024155833,
                -0.022208795,
                0.024771348,
                0.0077504674,
                -0.0066136485,
                -0.00084790366,
                0.00056409143,
                0.000058538717,
                0.02371618,
                -0.011738755,
                0.029293502,
                -0.007065864,
                -0.009697505,
                -0.012900697,
                -0.04735699,
                0.008623494,
                0.012203532,
                -0.009948736,
                -0.016417926,
                0.0020475304,
                0.0072919712,
                0.0010559541,
                -0.006224241,
                0.007763029,
                0.007819556,
                -0.0066890176,
                0.000046713212,
                0.027208285,
                -0.017573588,
                -0.019847225,
                -0.007518079,
                -0.030223055,
                0.021455104,
                0.016970634,
                0.029092517,
                -0.012950943,
                0.0008518291,
                -0.0038312683,
                -0.014897982,
                0.00981684,
                0.009421152,
                -0.010507724,
                -0.0010928536,
                -0.013478528,
                0.010237652,
                -0.01423222,
                0.0066890176,
                -0.020425057,
                0.03763436,
                0.0056307083,
                0.01071499,
                -0.04328705,
                0.0076499754,
                0.02110338,
                0.001947038,
                -0.000703446,
                0.014747242,
                0.0045221527,
                -0.012536412,
                -0.0053260913,
                -0.017900188,
                0.020299442,
                -0.0024526399,
                0.009848244,
                0.0053386525,
                -0.015689358,
                0.011393312,
                0.0027965119,
                0.015036158,
                -0.0048613143,
                0.006390681,
                -0.005300968,
                -0.027333902,
                0.017473096,
                -0.00088637334,
                -0.002634782,
                -0.01693295,
                -0.025135633,
                -0.0061896965,
                -0.011902055,
                -0.015262266,
                0.01602852,
                0.018942796,
                -0.0041264645,
                -0.009452555,
                -0.013189612,
                0.02151791,
                -0.004845612,
                0.0151492115,
                -0.017787134,
                -0.01071499,
                -0.011481243,
                0.0075746058,
                0.027132917,
                0.010482602,
                -0.0069276867,
                -0.011273978,
                -0.023841795,
                0.004456205,
                0.014094043,
                -0.0017444832,
                -0.018352404,
                -0.0032440166,
                -0.008466475,
                0.011412155,
                -0.0067204214,
                0.010802921,
                -0.0014696997,
                -0.01635512,
                -0.016757088,
                -0.01627975,
                -0.010231371,
                0.011914616,
                0.03637821,
                -0.004873876,
                0.009697505,
                0.016417926,
                0.010539128,
                0.020965204,
                0.038513668,
                -0.01063334,
                -0.0089186905,
                -0.027057547,
                0.02233441,
                -0.0070721447,
                0.010890852,
                -0.004211255,
                -0.005404601,
                0.022774065,
                0.017071126,
                -0.009144798,
                0.016229505,
                -0.007913767,
                -0.008077067,
                0.011738755,
                0.019219149,
                -0.017812258,
                -0.0016534121,
                -0.006890002,
                -0.026253609,
                -0.0007026609,
                -0.0036271433,
                0.0013354482,
                -0.021065695,
                0.0037558991,
                -0.006959091,
                -0.018201666,
                0.025550164,
                -0.0031199714,
                0.0138930585,
                -0.0075683254,
                -0.004537855,
                -0.0024652013,
                0.014985912,
                -0.00094525557,
                0.0021574437,
                0.0028577494,
                -0.006309031,
                0.0027070108,
                0.024193518,
                0.015978273,
                -0.007957733,
                -0.01259294,
                0.008039383,
                0.016719405,
                0.016706843,
                0.022296725,
                0.0055364966,
                0.0050183334,
                -0.0065885256,
                0.0110604325,
                -0.018440334,
                -0.01406892,
                -0.0031466647,
                0.01874181,
                -0.0060735024,
                0.033840775,
                0.0055584796,
                0.002879732,
                0.017272111,
                -0.037860468,
                0.00515337,
                -0.018364966,
                -0.002641063,
                -0.014445766,
                -0.02527381,
                -0.010765236,
                -0.02004821,
                0.020927519,
                -0.006839756,
                0.00002043703,
                0.028489564,
                0.0129635045,
                0.008384825,
                0.03788559,
                0.010287898,
                0.010193686,
                0.024582924,
                -0.008102191,
                -0.0018182823,
                0.010928536,
                0.0060735024,
                -0.015752167,
                -0.014634189,
                0.01880462,
                -0.017636396,
                0.03836293,
                -0.0013637117,
                -0.016103888,
                0.00028184947,
                -0.0005154155,
                0.022120865,
                -0.0073987446,
                -0.032433886,
                0.016895266,
                0.010074352,
                -0.0038501106,
                -0.008453913,
                0.0012616492,
                -0.0038815145,
                -0.0002422021,
                0.0102941785,
                0.007109829,
                0.014269904,
                -0.021505348,
                -0.013390597,
                0.014295028,
                -0.0043148873,
                0.0039694454,
                -0.011600578,
                -0.014207097,
                0.0006473116,
                -0.016242066,
                0.011010186,
                -0.0017115092,
                -0.0012954084,
                0.014609066,
                -0.0094462745,
                0.0027776696,
                -0.023603125,
                -0.0013275973,
                -0.009672383,
                -0.005363776,
                -0.014960789,
                -0.004321168,
                -0.0136920735,
                -0.00957189,
                0.0076750983,
                -0.036780175,
                -0.029218132,
                0.034544222,
                0.023979971,
                -0.016543543,
                -0.017875066,
                0.0050465968,
                -0.006739264,
                0.11245087,
                0.003019479,
                -0.022786625,
                0.0004278773,
                0.0039977087,
                -0.010966221,
                -0.020500425,
                -0.03075064,
                0.01595315,
                -0.0060986257,
                0.013817689,
                -0.0014367256,
                -0.0015403583,
                -0.0010096334,
                0.020600919,
                -0.0061080465,
                -0.007222883,
                -0.015111527,
                -0.014659312,
                -0.01825191,
                -0.017686643,
                0.002273638,
                -0.016958073,
                0.01807605,
                -0.003608301,
                -0.011675947,
                0.017837381,
                0.024118148,
                0.024080465,
                -0.02298761,
                -0.005772026,
                0.027057547,
                -0.009012902,
                -0.0010316161,
                0.015475811,
                0.007995417,
                0.003931761,
                0.002716432,
                -0.0065319985,
                -0.0014979631,
                -0.0033413684,
                0.010042948,
                0.017460534,
                -0.016455611,
                0.013604143,
                -0.007825837,
                0.0040353932,
                0.005819131,
                -0.002257936,
                -0.028765917,
                -0.0053951796,
                0.007084706,
                -0.0060263965,
                -0.0018591073,
                0.0028750214,
                0.028740793,
                -0.019922595,
                0.0021747157,
                -0.012586659,
                0.007624852,
                -0.008617213,
                -0.0026881685,
                0.0036679683,
                -0.010394671,
                -0.013101682,
                -0.017674081,
                -0.011562893,
                -0.024582924,
                -0.049341712,
                0.018540826,
                0.0027603975,
                -0.005062299,
                -0.02061348,
                -0.006758106,
                0.023276525,
                0.019508066,
                0.022799186,
                -0.008227806,
                0.0019611698,
                0.0020569514,
                0.019583434,
                -0.02511051,
                0.022447465,
                -0.011380752,
                -0.015450689,
                0.009502802,
                0.015890343,
                0.005266424,
                -0.0325595,
                -0.029067393,
                0.0006445638,
                0.024545241,
                0.021166187,
                -0.030725516,
                0.010507724,
                0.0079891365,
                0.004760822,
                0.029745717,
                0.015676796,
                -0.00482677,
                0.013214735,
                -0.015852658,
                -0.012643185,
                -0.010708709,
                0.019746734,
                0.007536921,
                0.006233662,
                0.029318623,
                -0.0058850795,
                -0.01177644,
                0.010608217,
                -0.012888135,
                0.0025704042,
                0.008881005,
                0.005103124,
                0.010966221,
                0.0046980144,
                0.0030367512,
                -0.014169412,
                -0.0043996777,
                -0.020274319,
                -0.0338659,
                0.004198693,
                0.00020785416,
                -0.022372095,
                0.022786625,
                -0.014872858,
                -0.021178748,
                -0.028514685,
                -0.0057971487,
                -0.00051659317,
                0.012065355,
                -0.020148704,
                -0.016003396,
                0.0005986357,
                -0.020651165,
                -0.00752436,
                -0.009188763,
                -0.027283655,
                -0.017950434,
                -0.015299951,
                -0.027233409,
                -0.03343881,
                -0.015036158,
                -0.01423222,
                -0.021316925,
                -0.011525209,
                0.0145839425,
                -0.005225599,
                0.021857072,
                -0.012662028,
                -0.0064158044,
                -0.012618062,
                0.020801904,
                0.009125955,
                -0.007216602,
                0.0000937699,
                -0.0021778562,
                0.033137333,
                -0.015488373,
                0.034644715,
                0.013968428,
                -0.0005162006,
                0.013227297,
                -0.0040919203,
                -0.02485928,
                -0.005750043,
                -0.012580378,
                -0.0072354446,
                0.002283059,
                0.0082717715,
                0.017209304,
                0.0030414618,
                0.0019564591,
                -0.008045663,
                0.004490749,
                -0.0011493805,
                0.0023678495,
                -0.023665933,
                -0.023728741,
                -0.013177051,
                -0.011946021,
                -0.008114752,
                -0.0022752082,
                0.0037496183,
                -0.009427433,
                0.033489052,
                -0.00025142697,
                -0.004041674,
                -0.032659993,
                0.027585132,
                -0.013214735,
                0.027333902,
                -0.0040448145,
                0.0078069945,
                -0.010168563,
                0.012938382,
                0.013227297,
                -0.02315091,
                0.0048958585,
                0.012253778,
                0.010608217,
                -0.0029064254,
                0.007373621,
                -0.0077190637,
                0.003394755,
                -0.015299951,
                -0.0044279415,
                0.0013943304,
                -0.00310741,
                -0.0081901215,
                -0.037458498,
                -0.0358255,
                -0.017473096,
                -0.0060075545,
                0.021857072,
                -0.017812258,
                0.012178409,
                -0.013076559,
                -0.02675607,
                0.0047545414,
                -0.00719776,
                0.028615179,
                0.01537532,
                0.00034877888,
                0.008089629,
                -0.017950434,
                -0.007248006,
                0.011770159,
                0.008742829,
                -0.021831948,
                0.021932442,
                0.006657614,
                -0.005300968,
                0.0131268045,
                0.008868444,
                0.00965354,
                -0.008887286,
                -0.046653543,
                0.015136651,
                -0.010897133,
                -0.0024683417,
                -0.0038249877,
                -0.027283655,
                -0.015689358,
                0.030725516,
                -0.006494314,
                -0.01553862,
                -0.023188595,
                -0.011989986,
                -0.015124089,
                0.019018166,
                0.00670786,
                0.0059102024,
                0.011707352,
                -0.012812766,
                -0.012228655,
                -0.0016110169,
                -0.010557971,
                -0.011066712,
                -0.013239859,
                0.035750132,
                0.0025704042,
                -0.0055930237,
                0.0070470213,
                -0.008089629,
                0.017033443,
                0.0011085555,
                -0.018565949,
                0.019997966,
                -0.01798812,
                -0.010696148,
                -0.03147921,
                0.02420608,
                -0.014709558,
                0.019671366,
                -0.0014178833,
                -0.00058685924,
                -0.022221357,
                -0.01325242,
                0.018879987,
                -0.008196402,
                -0.033011716,
                -0.0015898193,
                -0.011129521,
                -0.009640979,
                -0.030298423,
                -0.0063215927,
                0.01562655,
                -0.03140384,
                -0.03698116,
                -0.006469191,
                -0.0005428939,
                0.02748464,
                -0.006795791,
                0.004801647,
                0.0009688084,
                0.022485148,
                -0.019746734,
                0.02512307,
                0.01439552,
                0.011167205,
                -0.03630284,
                0.00081807,
                0.006890002,
                -0.027685624,
                0.0087553905,
                -0.011430997,
                -0.022309287,
                -0.012498728,
                0.017297234,
                -0.01038839,
                0.001725641,
                -0.023590565,
                0.0068837213,
                0.015463251,
                0.00036349945,
                0.0005287621,
                -0.012737397,
                0.018565949,
                0.0043588527,
                0.019281957,
                0.014985912,
                -0.020512987,
                -0.0063435757,
                0.017975558,
                0.0035078088,
                0.006814633,
                -0.003019479,
                -0.0042772028,
                -0.011757597,
                0.01488542,
                0.0011226872,
                -0.038965885,
                -0.005118826,
                0.020638604,
                -0.019194026,
                0.018452896,
                0.016995758,
                0.013051435,
                -0.009716348,
                0.020877272,
                -0.007367341,
                -0.007618571,
                0.007920048,
                0.001758615,
                0.0034010357,
                -0.009226448,
                -0.025336618,
                -0.04130233,
                0.0047985064,
                0.031202855,
                0.016015958,
                -0.012360551,
                -0.019420134,
                -0.0015961002,
                -0.012793924,
                0.0017130794,
                -0.00034819008,
                0.012052793,
                0.016154135,
                -0.013114243,
                -0.002038109,
                0.019696487,
                -0.013101682,
                -0.006896283,
                0.011569174,
                0.0055773216,
                -0.026052624,
                -0.0006928472,
                -0.0022202514,
                0.011964862,
                -0.004597522,
                0.0042332374,
                0.008208963,
                0.0044185203,
                -0.019043287,
                0.013352912,
                -0.015689358,
                -0.0061551523,
                -0.019093534,
                0.0025908167,
                0.032258023,
                0.0070909867,
                0.007134952,
                -0.00662621,
                -0.01791275,
                -0.00023906173,
                0.00662621,
                -0.01742285,
                0.02094008,
                0.031152608,
                0.008767952,
                0.009427433,
                -0.026580209,
                0.0075055175,
                0.026931932,
                -0.01292582,
                0.0153501965,
                0.002528009,
                -0.002545281,
                0.013491089,
                -0.011412155,
                -0.020224072,
                -0.0024667715,
                0.012197251,
                -0.010614498,
                0.018050926,
                0.0028357666,
                -0.029393993,
                -0.01276252,
                0.0006241513,
                -0.011556612,
                -0.01857851,
                -0.015136651,
                -0.013202174,
                -0.0031843493,
                -0.033740286,
                0.01725955,
                -0.009546767,
                0.0055584796,
                0.002674037,
                -0.04042302,
                -0.002633212,
                0.0017774573,
                -0.023025295,
                -0.0015434987,
                -0.015890343,
                -0.021605842,
                0.011311662,
                -0.008391106,
                -0.03303684,
                -0.0025656936,
                0.0034544223,
                0.0007748897,
                0.008937533,
                0.24138246,
                0.014546258,
                -0.013641828,
                0.027685624,
                0.00580657,
                0.001906213,
                0.021367172,
                0.0068585984,
                -0.00171779,
                0.0007116895,
                -0.013943304,
                -0.0023128928,
                -0.023578003,
                0.005819131,
                0.014269904,
                0.0032628588,
                -0.026906809,
                0.00028400848,
                -0.019847225,
                -0.032006793,
                0.016342558,
                -0.01120489,
                -0.01300119,
                -0.011537771,
                0.014646751,
                0.028188085,
                0.0021213293,
                -0.0027745292,
                -0.0013550756,
                -0.0019046428,
                -0.0067455447,
                0.004858174,
                -0.014634189,
                0.008252929,
                -0.01749822,
                0.0066952985,
                0.038664408,
                0.030725516,
                0.0007968724,
                0.00924529,
                0.027308779,
                -0.008862163,
                -0.008353421,
                0.004704295,
                0.011110678,
                0.023263965,
                -0.0058285524,
                -0.0037590396,
                0.022058057,
                0.026354102,
                -0.026228486,
                0.019244272,
                0.029142763,
                0.055521987,
                -0.008868444,
                0.0021590139,
                0.0022956207,
                0.0039129183,
                -0.0036114415,
                0.016870143,
                -0.027333902,
                0.03343881,
                -0.007712783,
                0.006268206,
                0.00052287395,
                0.03944322,
                -0.018226787,
                0.01455882,
                -0.0031874897,
                -0.011324224,
                0.020274319,
                -0.0056997966,
                -0.01423222,
                0.0045095915,
                -0.044141237,
                -0.01169479,
                -0.00042238162,
                0.014521135,
                0.011902055,
                0.04213139,
                -0.006428366,
                0.008491598,
                -0.010206248,
                -0.00046399172,
                -0.019030726,
                -0.013390597,
                0.0031639368,
                -0.011167205,
                -0.0030163387,
                0.0011462402,
                0.010005263,
                -0.021153625,
                -0.005112545,
                -0.0028844427,
                0.025562724,
                0.007844679,
                0.013465966,
                0.03637821,
                0.021128504,
                -0.01996028,
                -0.029620102,
                -0.04064913,
                0.011035309,
                0.018628757,
                -0.01972161,
                -0.0023427263,
                -0.010206248,
                0.00077096425,
                0.0018355544,
                -0.01660635,
                -0.011933459,
                -0.015073842,
                0.016304873,
                -0.008296894,
                0.009892209,
                -0.007945172,
                -0.004619505,
                -0.008981498,
                0.009427433,
                0.0015309372,
                -0.004572399,
                -0.028238332,
                -0.02028688,
                0.007681379,
                0.0072668483,
                -0.021744018,
                -0.016782211,
                -0.00605152,
                0.008780513,
                -0.027911732,
                0.008579529,
                -0.013805128,
                0.0074050254,
                -0.0009860805,
                -0.0056526912,
                0.01766152,
                0.020952642,
                -0.006331014,
                -0.0022218216,
                -0.025952132,
                -0.004704295,
                0.008051944,
                0.008252929,
                0.028590055,
                -0.007436429,
                -0.02683144,
                0.024419624,
                -0.03499644,
                -0.009760313,
                -0.010369548,
                -0.027384147,
                -0.00940231,
                -0.0071789175,
                0.0094839595,
                0.0073422175,
                -0.016719405,
                -0.02478391,
                -0.01864132,
                -0.022384657,
                0.00703446,
                -0.03770973,
                0.012668309,
                0.028615179,
                -0.033187576,
                -0.012863012,
                0.0016070915,
                -0.15917978,
                0.01815142,
                0.003583178,
                -0.025411986,
                -0.0016659737,
                0.009144798,
                0.0073987446,
                -0.017297234,
                -0.015299951,
                0.019910034,
                0.011745036,
                -0.009772874,
                -0.026806317,
                0.0055113737,
                -0.010457478,
                0.0022610764,
                -0.008007979,
                0.014872858,
                -0.014897982,
                0.016744526,
                0.01898048,
                -0.023188595,
                0.0069904947,
                0.0014461468,
                0.007379902,
                -0.032283146,
                -0.02445731,
                0.01562655,
                -0.019432696,
                -0.04924122,
                -0.017774573,
                0.008642336,
                0.009301817,
                -0.0057688854,
                0.038664408,
                -0.010250213,
                0.008221525,
                -0.007141233,
                -0.010068071,
                0.020148704,
                0.043136314,
                0.038890515,
                0.021216433,
                0.0055773216,
                -0.023954848,
                0.020600919,
                0.0125175705,
                0.030524531,
                -0.0019030727,
                -0.012008828,
                0.002119759,
                -0.014822612,
                0.026580209,
                -0.0079891365,
                0.008102191,
                0.016945511,
                0.00033759128,
                0.027610255,
                0.015011035,
                -0.021630965,
                -0.014684435,
                -0.034368362,
                0.011437278,
                -0.0013809839,
                -0.0011321084,
                0.015098966,
                -0.022359533,
                0.0011909906,
                -0.014445766,
                0.008428791,
                0.012335428,
                -0.018628757,
                0.012486166,
                -0.006519437,
                -0.011619421,
                0.015676796,
                -0.03886539,
                -0.0012969786,
                0.00027753142,
                0.002895434,
                -0.012077916,
                0.04074962,
                -0.03605161,
                -0.00084633345,
                0.016945511,
                -0.015902905,
                0.020952642,
                -0.018189104,
                0.00678951,
                0.005775166,
                0.032408763,
                -0.01816398,
                -0.010325583,
                -0.007964013,
                0.013604143,
                0.019281957,
                0.0328861,
                0.020349687,
                -0.00040864246,
                -0.013151928,
                -0.0039977087,
                -0.012140724,
                -0.02420608,
                0.0016518419,
                0.034493975,
                0.00038528585,
                -0.012548974,
                0.012417078,
                0.02708267,
                0.0021951282,
                -0.0066199293,
                0.024633171,
                0.028012224,
                0.012913259,
                -0.007869802,
                0.018679004,
                0.00076939404,
                -0.027911732,
                0.0051502297,
                0.0059918524,
                0.059039216,
                0.018716687,
                -0.008146156,
                0.013641828,
                0.0035486338,
                -0.029946702,
                -0.09923613,
                -0.011650824,
                -0.0089186905,
                -0.0119523015,
                0.016430488,
                0.02462061,
                0.012228655,
                0.008435071,
                -0.0048613143,
                0.019658804,
                -0.0045598373,
                -0.019897472,
                0.010922255,
                -0.012046512,
                -0.00033013287,
                -0.026906809,
                0.0140563585,
                -0.01267459,
                -0.005392039,
                0.010319302,
                0.027861485,
                0.014759804,
                0.015362758,
                -0.009220167,
                -0.0048707356,
                -0.002568834,
                -0.03441861,
                -0.012084197,
                0.013365474,
                -0.0036114415,
                0.0036773896,
                -0.020236634,
                -0.007920048,
                0.0032408761,
                -0.030223055,
                0.012335428,
                -0.033740286,
                0.0047828048,
                -0.00015417322,
                -0.037785098,
                0.020198949,
                0.02159328,
                0.010809202,
                -0.025487356,
                0.006186556,
                0.00020333986,
                -0.030574778,
                0.020412495,
                0.015915466,
                -0.010834324,
                -0.008460194,
                0.0136920735,
                -0.00973519,
                0.0029865052,
                0.041603807,
                -0.007461552,
                0.009515363,
                0.03376541,
                0.012467324,
                0.0017554746,
                0.0032942628,
                0.0020506708,
                0.005784587,
                0.024469871,
                0.0087553905,
                -0.010256493,
                -0.0054422854,
                -0.014433204,
                0.023414703,
                -0.016392805,
                0.0010049229,
                0.014797489,
                -0.00237256,
                0.0030461724,
                0.0015921746,
                0.010356986,
                -0.019018166,
                -0.00092170265,
                0.00008057048,
                -0.00482677,
                -0.00033248815,
                -0.020663725,
                0.021480225,
                -0.021982687,
                0.002422806,
                0.02413071,
                0.00065751787,
                -0.007700221,
                0.002061662,
                0.0052318797,
                -0.003730776,
                0.018829742,
                0.009370905,
                -0.034066886,
                -0.01521202,
                0.035046685,
                0.0052224584,
                -0.019847225,
                -0.0042834836,
                0.012008828,
                -0.014043797,
                0.007863522,
                -0.049417082,
                0.026630456,
                -0.006971652,
                -0.04009642,
                0.0047733835,
                -0.019520625,
                -0.0074238675,
                -0.022510272,
                -0.011644543,
                0.01504872,
                0.015023597,
                0.027308779,
                -0.0005405386,
                0.002600238,
                -0.010451198,
                -0.006814633,
                -0.007436429,
                -0.0024793332,
                -0.0008620354,
                0.0010418224,
                -0.0055490583,
                0.014533697,
                -0.0027384148,
                0.01586522,
                -0.015438127,
                0.0011077704,
                -0.022748942,
                0.020902395,
                -0.012410797,
                -0.012523851,
                0.011148362,
                -0.033966392,
                0.005922764,
                0.04162893,
                -0.0097289095,
                -0.019872349,
                0.01988491,
                0.015802411,
                -0.0046320665,
                0.03675505,
                -0.023665933,
                -0.021744018,
                0.019910034,
                -0.02577627,
                0.0075934483,
                0.01504872,
                -0.018704126,
                -0.0037810223,
                0.03625259,
                -0.0034638434,
                0.016367681,
                0.01832728,
                -0.0015560603,
                -0.012567816,
                0.0056181466,
                -0.022761503,
                0.010137159,
                -0.02534918,
                -0.015588866,
                -0.033639792,
                0.034493975,
                0.008416229,
                0.0040856395,
                -0.021831948,
                0.0052570025,
                0.01374232,
                0.009169921,
                -0.00507172,
                -0.011456121,
                -0.0345191,
                -0.014458328,
                -0.006494314,
                0.010966221,
                0.019244272,
                0.00924529,
                0.01439552,
                0.01733492,
                0.017862504,
                -0.011512647,
                0.028992023,
                -0.010049229,
                -0.01439552,
                -0.017196743,
                0.006808352,
                0.04195553,
                0.024331694,
                -0.0069276867,
                0.0041672895,
                0.018063487,
                0.014860297,
                -0.00096488296,
                -0.014709558,
                -0.004443643,
                -0.015073842,
                0.013264982,
                0.003451282,
                -0.0051502297,
                0.02070141,
                0.0077253445,
                0.01586522,
                0.005853676,
                -0.012819047,
                -0.019457819,
                -0.009609574,
                -0.025411986,
                0.0038720933,
                0.0022390937,
                -0.026806317,
                -0.013503651,
                0.01693295,
                0.0004145307,
                0.030800885,
                -0.01218469,
                0.009936174,
                -0.0061802757,
                0.0005004987,
                -0.0048644547,
                -0.016870143,
                -0.015475811,
                0.033463933,
                0.0146216275,
                0.019093534,
                0.026027502,
                -0.006142591,
                -0.0074175866,
                0.036528945,
                -0.003066585,
                -0.0072605675,
                0.000057655485,
                -0.00981684,
                -0.018565949,
                -0.019608557,
                -0.0056118662,
                0.005586743,
                -0.0039537433,
                -0.010495163,
                -0.02331421,
                0.016819896,
                -0.012228655,
                0.041503314,
                0.006431506,
                -0.028891532,
                0.0058505354,
                -0.0079074865,
                0.024570365,
                0.023402141,
                -0.014370397,
                -0.035272792,
                -0.009998983,
                0.018013243,
                -0.018277034,
                0.043086067,
                0.0028153541,
                -0.005586743,
                0.0046666106,
                0.0153501965,
                0.0066701756,
                -0.0076625366,
                0.0066952985,
                0.033740286,
                -0.0061802757,
                0.007536921,
                0.0021825668,
                -0.016129011,
                -0.0103758285,
                0.046477683,
                -0.0018638178,
                -0.012209812,
                -0.0341925,
                0.012718555,
                -0.008026822,
                -0.003379053,
                -0.012611782,
                -0.014483451,
                -0.007706502,
                0.0012208242,
                -0.0077567482,
                0.0019486082,
                -0.0032911224,
                0.008240367,
                -0.0038312683,
                -0.018440334,
                -0.011261417,
                0.033489052,
                -0.010112036,
                -0.013717197,
                -0.007229164,
                0.0036930915
            ]
        }
    ],
    "model": "ada",
    "usage": {
        "prompt_tokens": 6,
        "total_tokens": 6
    }
}'

-- select @jsonExample1


drop table if exists #t;
select
    cast([key] as int) as [vector_value_id],
    cast([value] as float) as [vector_value]
into
	#t
from 
    openjson(@jsonExample1, '$.data[0].embedding')

drop table if exists #results;
select top(25)
    v2.Id, 
    sum(v1.[vector_value] * v2.[vector_value]) / 
        (
            sqrt(sum(v1.[vector_value] * v1.[vector_value])) 
            * 
            --sqrt(sum(v2.[vector_value] * v2.[vector_value]))
			--pre-computing 1536 dimension vectors saves about 500ms on non-filtered queries
			b1.ParagraphEmbeddingsCosineSimilarityDenominator
        ) as cosine_distance
into
    #results
from 
    #t v1
inner join 
    dbo.ProjectGutenbergBooksVectorsIndex v2 on v1.vector_value_id = v2.vector_value_id
inner join
	dbo.ProjectGutenbergBooks b1 on b1.Id = v2.Id
where
	b1.Author = 'Edgar Allen Poe'
group by
    v2.Id, b1.ParagraphEmbeddingsCosineSimilarityDenominator
order by
    cosine_distance desc;

select 
    a.Id,
    a.BookTitle,
	a.Author,
	a.Paragraph,
    a.Url,
    r.cosine_distance
from 
    #results r
inner join 
    dbo.ProjectGutenbergBooks a on r.Id = a.Id
order by
    cosine_distance desc;
go